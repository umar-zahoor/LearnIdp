2018-04-23 19:15:06.645 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:15:06.694 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:15:06.698 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:15:06.698 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:15:06.698 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:15:16.587 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:15:16.598 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:15:16.599 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:15:16.607 +05:30 [DBG] Start discovery request
2018-04-23 19:15:17.423 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:17:36.478 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:17:36.510 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:17:36.510 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:17:36.510 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:17:36.510 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:19:50.736 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:19:50.770 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:19:50.770 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:19:50.770 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:19:50.770 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:20:30.363 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:20:30.395 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:20:30.396 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:20:30.396 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:20:30.396 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:20:55.500 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:20:55.507 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:20:55.508 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:20:55.514 +05:30 [DBG] Start discovery request
2018-04-23 19:20:56.695 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:20:57.054 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:20:57.092 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:20:57.094 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:20:57.103 +05:30 [DBG] Start key discovery request
2018-04-23 19:20:57.206 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 19:20:57.217 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 19:20:57.218 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 19:20:57.227 +05:30 [DBG] Start authorize request
2018-04-23 19:20:57.241 +05:30 [DBG] No user present in authorize request
2018-04-23 19:20:57.247 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:20:57.801 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:20:57.816 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:20:57.819 +05:30 [DBG] No PKCE used.
2018-04-23 19:20:57.916 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:20:58.145 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:20:58.209 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:20:58.323 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:20:58.335 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:20:58.351 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
  "Nonce": "636600882571826206.NmQxYWE1YzQtZDEzNi00MGI1LWI1YTktOGY0NzRkNjUyYTMyYzc0NjdiZjMtNjVjNS00NmJlLTg5N2YtOWNiNjliNTA2ODFj",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600882571826206.NmQxYWE1YzQtZDEzNi00MGI1LWI1YTktOGY0NzRkNjUyYTMyYzc0NjdiZjMtNjVjNS00NmJlLTg5N2YtOWNiNjliNTA2ODFj",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:20:58.369 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 19:20:58.688 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:20:59.061 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:20:59.064 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:20:59.065 +05:30 [DBG] No PKCE used.
2018-04-23 19:20:59.170 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:20:59.344 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:20:59.417 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:20:59.606 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:20:59.608 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:20:59.900 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:12.035 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:21:12.237 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:21:12.240 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 19:21:12.240 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 19:21:12.253 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:21:12.283 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:12.287 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:12.290 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:21:12.294 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:21:12.295 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:21:12.303 +05:30 [DBG] Start authorize callback request
2018-04-23 19:21:12.308 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:21:12.309 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:21:12.553 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:12.554 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:21:12.555 +05:30 [DBG] No PKCE used.
2018-04-23 19:21:12.605 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:12.727 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:12.777 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:12.896 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:12.897 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:21:12.899 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
  "Nonce": "636600882571826206.NmQxYWE1YzQtZDEzNi00MGI1LWI1YTktOGY0NzRkNjUyYTMyYzc0NjdiZjMtNjVjNS00NmJlLTg5N2YtOWNiNjliNTA2ODFj",
  "SessionId": "a4b3ba23c58c3f3d1f9ecb08e895f42d",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600882571826206.NmQxYWE1YzQtZDEzNi00MGI1LWI1YTktOGY0NzRkNjUyYTMyYzc0NjdiZjMtNjVjNS00NmJlLTg5N2YtOWNiNjliNTA2ODFj",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:21:12.957 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:21:12.957 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 19:21:12.974 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:12.977 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:13.025 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:21:13.352 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:13.353 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:21:13.354 +05:30 [DBG] No PKCE used.
2018-04-23 19:21:13.421 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:13.596 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:13.662 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:13.826 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:13.827 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:21:14.122 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:14.191 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:14.410 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:14.832 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:14.836 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:24.331 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:21:24.336 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:24.339 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:24.393 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:21:24.752 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:24.754 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:21:24.754 +05:30 [DBG] No PKCE used.
2018-04-23 19:21:24.830 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:25.084 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:25.156 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:25.333 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:25.336 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:21:25.370 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:25.375 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:21:25.378 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:21:25.379 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:21:25.380 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:21:25.386 +05:30 [DBG] Start authorize callback request
2018-04-23 19:21:25.429 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:21:25.431 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:21:25.740 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:25.742 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:21:25.742 +05:30 [DBG] No PKCE used.
2018-04-23 19:21:25.816 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:26.051 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:26.134 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:26.269 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:26.270 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:21:26.271 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
  "Nonce": "636600882571826206.NmQxYWE1YzQtZDEzNi00MGI1LWI1YTktOGY0NzRkNjUyYTMyYzc0NjdiZjMtNjVjNS00NmJlLTg5N2YtOWNiNjliNTA2ODFj",
  "SessionId": "a4b3ba23c58c3f3d1f9ecb08e895f42d",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600882571826206.NmQxYWE1YzQtZDEzNi00MGI1LWI1YTktOGY0NzRkNjUyYTMyYzc0NjdiZjMtNjVjNS00NmJlLTg5N2YtOWNiNjliNTA2ODFj",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:21:26.310 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:21:26.317 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 19:21:26.327 +05:30 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:21:26.398 +05:30 [DBG] no jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= persisted grant found in database
2018-04-23 19:21:26.408 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 19:21:26.491 +05:30 [DBG] c9wQQtVvorf3R1MV2aYjyMSshMx9JWu9k4iefbd/ddk= not found in database
2018-04-23 19:21:26.583 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 19:21:26.595 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:21:26.598 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:21:26.672 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqtQMGASemdcdg9nhLGRFFMCXFCAFlBEO1q6Pq13vF-mM8dm9mK-RhUJ_Xc6e80DXftcKddLRZdwFusmZ3Fy2NoWhvc9fSkKYcadVtPtmswI0bMG9SsoUgdMO2RrmCNjxpE4k6Vx9n1kJRj3B815CTc0uZLYCSEd0rNezQc2olUjCqwgEYqjfZ18pMcrAxbH9-ILq2GmPcRXQv8uc8AM6W-xzkxoeyMoSueEBKmqVJW7aJOQ35ynbfhQWpUqCPJlM1kh5_Z9ectJgtOXiQbOJdqysGjkg236bvbA-o21uyeQfm8Q2Okoj6ghiR58k3zlUJU",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 19:21:26.697 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:21:26.698 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:21:26.852 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:21:26.860 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:21:26.861 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:21:26.872 +05:30 [DBG] Start token request.
2018-04-23 19:21:26.880 +05:30 [DBG] Start client validation
2018-04-23 19:21:26.886 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:21:26.890 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:21:26.891 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:21:26.894 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:21:27.115 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:27.130 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:21:27.130 +05:30 [DBG] Client validation success
2018-04-23 19:21:27.138 +05:30 [DBG] Start token request validation
2018-04-23 19:21:27.150 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 19:21:27.204 +05:30 [DBG] c9wQQtVvorf3R1MV2aYjyMSshMx9JWu9k4iefbd/ddk= found in database: true
2018-04-23 19:21:27.256 +05:30 [DBG] removing c9wQQtVvorf3R1MV2aYjyMSshMx9JWu9k4iefbd/ddk= persisted grant from database
2018-04-23 19:21:27.312 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 19:21:27.318 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "f614207bbcdcddbb163950b4643e2a6c4cd43f975a382a3485c14ad6d5ed05d5",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "f614207bbcdcddbb163950b4643e2a6c4cd43f975a382a3485c14ad6d5ed05d5",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 19:21:27.562 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:27.618 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:27.809 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:27.822 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 19:21:27.824 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:21:27.954 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= not found in database
2018-04-23 19:21:27.988 +05:30 [DBG] Creating refresh token
2018-04-23 19:21:27.989 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 19:21:28.033 +05:30 [DBG] ekdc7ooqpjmchXj7YMJGfKPSqYD7CEo2zqdZcFTrjE0= not found in database
2018-04-23 19:21:28.278 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:28.325 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:28.445 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:21:28.448 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:21:28.449 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:21:28.457 +05:30 [DBG] Token request success.
2018-04-23 19:21:28.482 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 19:21:28.486 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 19:21:28.487 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 19:21:28.496 +05:30 [DBG] Start userinfo request
2018-04-23 19:21:28.500 +05:30 [DBG] Bearer token found in header
2018-04-23 19:21:28.549 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= found in database: true
2018-04-23 19:21:28.792 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:29.017 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:29.045 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:21:29.053 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "3e0e1b29e962147dca0baae44930b37d94021618f0b8db7b46e182eef8645609",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491487,
    "exp": 1524491607,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491472,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:21:29.091 +05:30 [DBG] Creating userinfo response
2018-04-23 19:21:29.095 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:21:29.099 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:21:29.176 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:29.179 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 19:21:29.180 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:21:29.234 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:21:29.285 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 19:21:29.289 +05:30 [DBG] End userinfo request
2018-04-23 19:21:31.060 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:21:31.061 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:21:31.062 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:21:31.065 +05:30 [DBG] Start discovery request
2018-04-23 19:21:31.234 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:21:31.271 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:21:31.273 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:21:31.273 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:21:31.276 +05:30 [DBG] Start key discovery request
2018-04-23 19:21:31.466 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:21:31.470 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:21:31.471 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:21:31.482 +05:30 [DBG] Starting introspection request.
2018-04-23 19:21:31.492 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:21:31.492 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:21:31.493 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:21:31.493 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:21:31.667 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:21:31.668 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:21:31.669 +05:30 [DBG] API resource validation success
2018-04-23 19:21:31.673 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:21:31.701 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= found in database: true
2018-04-23 19:21:31.937 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:32.162 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:32.191 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:21:32.193 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "3e0e1b29e962147dca0baae44930b37d94021618f0b8db7b46e182eef8645609",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491487,
    "exp": 1524491607,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491472,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:21:32.195 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:21:32.208 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:21:32.211 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:21:52.967 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:21:52.973 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:21:52.975 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:21:52.980 +05:30 [DBG] Starting introspection request.
2018-04-23 19:21:52.981 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:21:52.983 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:21:52.985 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:21:52.986 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:21:53.098 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:21:53.099 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:21:53.099 +05:30 [DBG] API resource validation success
2018-04-23 19:21:53.100 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:21:53.125 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= found in database: true
2018-04-23 19:21:53.373 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:53.617 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:53.643 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:21:53.645 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "3e0e1b29e962147dca0baae44930b37d94021618f0b8db7b46e182eef8645609",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491487,
    "exp": 1524491607,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491472,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:21:53.647 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:21:53.648 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:21:53.649 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:21:56.683 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:21:56.687 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:21:56.688 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:21:56.690 +05:30 [DBG] Starting introspection request.
2018-04-23 19:21:56.690 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:21:56.691 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:21:56.692 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:21:56.692 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:21:56.804 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:21:56.805 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:21:56.805 +05:30 [DBG] API resource validation success
2018-04-23 19:21:56.806 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:21:56.830 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= found in database: true
2018-04-23 19:21:57.070 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:57.304 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:21:57.330 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:21:57.332 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "3e0e1b29e962147dca0baae44930b37d94021618f0b8db7b46e182eef8645609",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491487,
    "exp": 1524491607,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491472,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:21:57.333 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:21:57.334 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:21:57.334 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:21:59.983 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:21:59.986 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:21:59.991 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:21:59.994 +05:30 [DBG] Starting introspection request.
2018-04-23 19:21:59.994 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:21:59.995 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:21:59.997 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:21:59.997 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:22:00.132 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:22:00.135 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:22:00.135 +05:30 [DBG] API resource validation success
2018-04-23 19:22:00.136 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:22:00.161 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= found in database: true
2018-04-23 19:22:00.402 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:22:00.628 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:22:00.657 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:22:00.658 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "3e0e1b29e962147dca0baae44930b37d94021618f0b8db7b46e182eef8645609",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491487,
    "exp": 1524491607,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491472,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:22:00.660 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:22:00.661 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:22:00.661 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:22:02.441 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:22:02.443 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:22:02.443 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:22:02.446 +05:30 [DBG] Starting introspection request.
2018-04-23 19:22:02.446 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:22:02.447 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:22:02.448 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:22:02.448 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:22:02.566 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:22:02.568 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:22:02.569 +05:30 [DBG] API resource validation success
2018-04-23 19:22:02.569 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:22:02.594 +05:30 [DBG] PnpwfEZZy/T6x9408+kYxNe+4lu14g4OD/jZvQwsh/k= found in database: true
2018-04-23 19:22:02.836 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:22:03.061 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:22:03.086 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:22:03.089 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "3e0e1b29e962147dca0baae44930b37d94021618f0b8db7b46e182eef8645609",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491487,
    "exp": 1524491607,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491472,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:22:03.090 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:22:03.091 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:22:03.091 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:23:17.260 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:23:17.262 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:23:17.262 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:23:17.264 +05:30 [DBG] Start discovery request
2018-04-23 19:23:17.441 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:23:17.468 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:23:17.470 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:23:17.470 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:23:17.473 +05:30 [DBG] Start key discovery request
2018-04-23 19:23:17.504 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:23:17.506 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:23:17.507 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:23:17.509 +05:30 [DBG] Start token request.
2018-04-23 19:23:17.510 +05:30 [DBG] Start client validation
2018-04-23 19:23:17.510 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:23:17.511 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:23:17.511 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:23:17.757 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:17.759 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:23:17.759 +05:30 [DBG] Client validation success
2018-04-23 19:23:17.760 +05:30 [DBG] Start token request validation
2018-04-23 19:23:17.764 +05:30 [DBG] Start validation of refresh token request
2018-04-23 19:23:17.799 +05:30 [DBG] ekdc7ooqpjmchXj7YMJGfKPSqYD7CEo2zqdZcFTrjE0= found in database: false
2018-04-23 19:23:17.801 +05:30 [DBG] refresh_token grant with value: 437a4c69016bab6a4a531880c8c08184a155463120a2a3b55f59d9d116f0361f not found in store.
2018-04-23 19:23:17.803 +05:30 [ERR] Invalid refresh token
2018-04-23 19:23:17.806 +05:30 [ERR] Refresh token validation failed. aborting.
2018-04-23 19:23:17.808 +05:30 [ERR] {
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "437a4c69016bab6a4a531880c8c08184a155463120a2a3b55f59d9d116f0361f"
  }
}
2018-04-23 19:23:23.550 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:23:23.552 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:23:23.552 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:23:23.556 +05:30 [DBG] Start discovery request
2018-04-23 19:23:23.705 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:23:23.727 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:23:23.729 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:23:23.729 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:23:23.732 +05:30 [DBG] Start key discovery request
2018-04-23 19:23:23.746 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:23:23.748 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:23:23.748 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:23:23.751 +05:30 [DBG] Start token request.
2018-04-23 19:23:23.751 +05:30 [DBG] Start client validation
2018-04-23 19:23:23.752 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:23:23.752 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:23:23.753 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:23:23.974 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:23.975 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:23:23.976 +05:30 [DBG] Client validation success
2018-04-23 19:23:23.977 +05:30 [DBG] Start token request validation
2018-04-23 19:23:23.977 +05:30 [DBG] Start validation of refresh token request
2018-04-23 19:23:24.001 +05:30 [DBG] ekdc7ooqpjmchXj7YMJGfKPSqYD7CEo2zqdZcFTrjE0= found in database: false
2018-04-23 19:23:24.002 +05:30 [DBG] refresh_token grant with value: 437a4c69016bab6a4a531880c8c08184a155463120a2a3b55f59d9d116f0361f not found in store.
2018-04-23 19:23:24.003 +05:30 [ERR] Invalid refresh token
2018-04-23 19:23:24.005 +05:30 [ERR] Refresh token validation failed. aborting.
2018-04-23 19:23:24.007 +05:30 [ERR] {
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "437a4c69016bab6a4a531880c8c08184a155463120a2a3b55f59d9d116f0361f"
  }
}
2018-04-23 19:23:40.073 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 19:23:40.075 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 19:23:40.076 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 19:23:40.079 +05:30 [DBG] Start authorize request
2018-04-23 19:23:40.079 +05:30 [DBG] No user present in authorize request
2018-04-23 19:23:40.080 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:23:40.324 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:40.325 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:23:40.326 +05:30 [DBG] No PKCE used.
2018-04-23 19:23:40.375 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:40.562 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:40.609 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:40.729 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:40.731 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:23:40.732 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
  "Nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:23:40.736 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 19:23:40.778 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:23:41.110 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:41.112 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:23:41.112 +05:30 [DBG] No PKCE used.
2018-04-23 19:23:41.186 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:41.348 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:41.415 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:41.579 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:41.580 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:23:41.893 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:47.406 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:23:47.577 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:23:47.578 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 19:23:47.579 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 19:23:47.580 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:23:47.601 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:47.604 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:47.607 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:23:47.608 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:23:47.608 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:23:47.611 +05:30 [DBG] Start authorize callback request
2018-04-23 19:23:47.611 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:23:47.616 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:23:47.847 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:47.849 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:23:47.850 +05:30 [DBG] No PKCE used.
2018-04-23 19:23:47.899 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:48.014 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:48.069 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:48.186 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:48.188 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:23:48.188 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
  "Nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
  "SessionId": "c75b920cb40765e46db8276b08c8a539",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:23:48.222 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:23:48.223 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 19:23:48.242 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:48.245 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:48.275 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:23:48.585 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:48.587 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:23:48.587 +05:30 [DBG] No PKCE used.
2018-04-23 19:23:48.653 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:48.817 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:48.891 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:49.058 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:49.060 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:23:49.366 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:49.435 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:49.654 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:52.073 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:23:52.077 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:52.080 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:52.118 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:23:52.477 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:52.478 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:23:52.479 +05:30 [DBG] No PKCE used.
2018-04-23 19:23:52.552 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:52.769 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:52.837 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:53.035 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:53.037 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:23:53.054 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:53.057 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:23:53.061 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:23:53.063 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:23:53.063 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:23:53.066 +05:30 [DBG] Start authorize callback request
2018-04-23 19:23:53.067 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:23:53.068 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:23:53.315 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:53.317 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:23:53.317 +05:30 [DBG] No PKCE used.
2018-04-23 19:23:53.380 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:53.519 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:53.577 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:53.706 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:53.708 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:23:53.709 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
  "Nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
  "SessionId": "c75b920cb40765e46db8276b08c8a539",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:23:53.743 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:23:53.743 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 19:23:53.747 +05:30 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:23:53.776 +05:30 [DBG] no jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= persisted grant found in database
2018-04-23 19:23:53.777 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 19:23:53.819 +05:30 [DBG] 6Fc8Z8OmdfEF9BGfK24BlzmG7exS71wcfc4UFSp2/hk= not found in database
2018-04-23 19:23:53.852 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 19:23:53.853 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:23:53.854 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:23:53.859 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt2XEc2N2DpKKuhcICOFnsbzy2G6K-0xvoMLtI3U38D0QT-h6Gd9uHUk7VsJX1VYcCGstNAzSaNgFm5RJSdHOTq2ZyhgImKTJ13_l-wg4nBgMgAyb2PSxk6-98bLbVPfEs9yTDB_tfdlwPOnTb8BC25DihZtdahKWRESnX5ikH89U40nhY6IGRHECzDC1ZHNdNu-Ra-XZHEDMIVkAbcrhdr_3KLqEJwYe6upwzOvldBSccI2OohQRqubVrn3Tf7W-aoGyKBwxlyVkJCKS71lKBi_-zs1t0-AZp2LaxF2QP4uGCkpEQeEF80TAe1lhFVXTA",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 19:23:53.862 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:23:53.863 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:23:53.936 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:23:53.939 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:23:53.940 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:23:53.943 +05:30 [DBG] Start token request.
2018-04-23 19:23:53.944 +05:30 [DBG] Start client validation
2018-04-23 19:23:53.944 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:23:53.946 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:23:53.946 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:23:53.947 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:23:54.185 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:54.186 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:23:54.187 +05:30 [DBG] Client validation success
2018-04-23 19:23:54.187 +05:30 [DBG] Start token request validation
2018-04-23 19:23:54.188 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 19:23:54.216 +05:30 [DBG] 6Fc8Z8OmdfEF9BGfK24BlzmG7exS71wcfc4UFSp2/hk= found in database: true
2018-04-23 19:23:54.256 +05:30 [DBG] removing 6Fc8Z8OmdfEF9BGfK24BlzmG7exS71wcfc4UFSp2/hk= persisted grant from database
2018-04-23 19:23:54.308 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 19:23:54.309 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "5d831f37de0b4f5d684b2be679ad8daf8365f956731efd44037a92b3d2aad762",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "5d831f37de0b4f5d684b2be679ad8daf8365f956731efd44037a92b3d2aad762",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 19:23:54.537 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:54.590 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:54.779 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:54.781 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 19:23:54.781 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:23:54.870 +05:30 [DBG] wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= not found in database
2018-04-23 19:23:54.901 +05:30 [DBG] Creating refresh token
2018-04-23 19:23:54.901 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 19:23:54.943 +05:30 [DBG] im7br16nsoPcHUSYQGMlyA+vxpDFcBqo/kxD+QR5o0s= not found in database
2018-04-23 19:23:55.195 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:55.243 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:55.361 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:23:55.363 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:23:55.364 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:23:55.368 +05:30 [DBG] Token request success.
2018-04-23 19:23:55.380 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 19:23:55.381 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 19:23:55.383 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 19:23:55.386 +05:30 [DBG] Start userinfo request
2018-04-23 19:23:55.386 +05:30 [DBG] Bearer token found in header
2018-04-23 19:23:55.414 +05:30 [DBG] wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= found in database: true
2018-04-23 19:23:55.653 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:55.884 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:55.916 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:23:55.917 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "16e213d865cf0dc16981b1672779e0b1710796f416afa34ed36ed04223759bd2",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491634,
    "exp": 1524491754,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491627,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:23:55.948 +05:30 [DBG] Creating userinfo response
2018-04-23 19:23:55.948 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:23:55.950 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:23:56.004 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:56.006 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 19:23:56.006 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:23:56.052 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:23:56.098 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 19:23:56.101 +05:30 [DBG] End userinfo request
2018-04-23 19:23:56.127 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:23:56.130 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:23:56.131 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:23:56.134 +05:30 [DBG] Starting introspection request.
2018-04-23 19:23:56.134 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:23:56.134 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:23:56.135 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:23:56.135 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:23:56.259 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:23:56.260 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:23:56.260 +05:30 [DBG] API resource validation success
2018-04-23 19:23:56.261 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:23:56.287 +05:30 [DBG] wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= found in database: true
2018-04-23 19:23:56.524 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:56.743 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:23:56.771 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:23:56.773 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "16e213d865cf0dc16981b1672779e0b1710796f416afa34ed36ed04223759bd2",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491634,
    "exp": 1524491754,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491627,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:23:56.775 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:23:56.776 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:23:56.776 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:24:00.919 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:24:00.921 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:24:00.921 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:24:00.924 +05:30 [DBG] Starting introspection request.
2018-04-23 19:24:00.925 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:24:00.925 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:24:00.926 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:24:00.926 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:24:01.040 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:24:01.042 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:24:01.042 +05:30 [DBG] API resource validation success
2018-04-23 19:24:01.042 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:24:01.067 +05:30 [DBG] wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= found in database: true
2018-04-23 19:24:01.313 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:24:01.535 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:24:01.561 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:24:01.563 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "16e213d865cf0dc16981b1672779e0b1710796f416afa34ed36ed04223759bd2",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491634,
    "exp": 1524491754,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491627,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:24:01.565 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:24:01.565 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:24:01.566 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:24:34.520 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:24:34.523 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:24:34.524 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:24:34.526 +05:30 [DBG] Starting introspection request.
2018-04-23 19:24:34.526 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:24:34.527 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:24:34.528 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:24:34.528 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:24:34.639 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:24:34.640 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:24:34.643 +05:30 [DBG] API resource validation success
2018-04-23 19:24:34.645 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:24:34.671 +05:30 [DBG] wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= found in database: true
2018-04-23 19:24:34.905 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:24:35.170 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:24:35.202 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:24:35.204 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "16e213d865cf0dc16981b1672779e0b1710796f416afa34ed36ed04223759bd2",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524491634,
    "exp": 1524491754,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491627,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:24:35.206 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:24:35.207 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:24:35.207 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:26:46.319 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:26:46.322 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:26:46.322 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:26:46.325 +05:30 [DBG] Start discovery request
2018-04-23 19:26:46.491 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:26:46.504 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:26:46.505 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:26:46.506 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:26:46.510 +05:30 [DBG] Start key discovery request
2018-04-23 19:26:46.534 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:26:46.537 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:26:46.538 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:26:46.549 +05:30 [DBG] Start revocation request.
2018-04-23 19:26:46.550 +05:30 [DBG] Start client validation
2018-04-23 19:26:46.550 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:26:46.551 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:26:46.551 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:26:46.829 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:46.831 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:26:46.831 +05:30 [DBG] Client validation success
2018-04-23 19:26:46.834 +05:30 [DBG] Token type hint found in request: access_token
2018-04-23 19:26:46.834 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:26:46.873 +05:30 [DBG] wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= found in database: true
2018-04-23 19:26:46.893 +05:30 [DBG] Access token revoked
2018-04-23 19:26:46.921 +05:30 [DBG] removing wWKwH1p3Vpf3cZ3bFuSZwaMG1Wxc+MNtmQTe1XuIJLQ= persisted grant from database
2018-04-23 19:26:47.049 +05:30 [INF] Token successfully revoked
2018-04-23 19:26:47.062 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:26:47.064 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:26:47.064 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:26:47.067 +05:30 [DBG] Start revocation request.
2018-04-23 19:26:47.067 +05:30 [DBG] Start client validation
2018-04-23 19:26:47.068 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:26:47.070 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:26:47.070 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:26:47.332 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:47.333 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:26:47.334 +05:30 [DBG] Client validation success
2018-04-23 19:26:47.336 +05:30 [DBG] Token type hint found in request: refresh_token
2018-04-23 19:26:47.336 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:26:47.375 +05:30 [DBG] im7br16nsoPcHUSYQGMlyA+vxpDFcBqo/kxD+QR5o0s= found in database: true
2018-04-23 19:26:47.389 +05:30 [DBG] Refresh token revoked
2018-04-23 19:26:47.418 +05:30 [DBG] removing im7br16nsoPcHUSYQGMlyA+vxpDFcBqo/kxD+QR5o0s= persisted grant from database
2018-04-23 19:26:47.486 +05:30 [DBG] removing 0 persisted grants from database for subject d860efca-22d9-47fd-8249-791ba61b07c7, clientId ImageGallery-WebApp, grantType reference_token
2018-04-23 19:26:47.489 +05:30 [INF] Token successfully revoked
2018-04-23 19:26:47.512 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:26:47.516 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:26:47.518 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-23 19:26:47.522 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-23 19:26:47.523 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-23 19:26:47.532 +05:30 [DBG] Processing signout request for d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:26:47.541 +05:30 [DBG] Start end session request validation
2018-04-23 19:26:47.549 +05:30 [DBG] Start identity token validation
2018-04-23 19:26:47.821 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:47.822 +05:30 [DBG] Client found: ImageGallery-WebApp / Image Gallery
2018-04-23 19:26:47.907 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:26:47.910 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524491635,
    "exp": 1524491935,
    "iss": "http://localhost:5000",
    "aud": "ImageGallery-WebApp",
    "nonce": "636600884200656451.ZDY5ZGQ1YjctMWEyYy00OTI0LTk0MTktOGIzY2FlYWNmZGJjYmMxYWMyMGEtMzM5YS00YmI2LTgyOWQtYzc2OTg4NzZjMjA3",
    "iat": 1524491635,
    "at_hash": "CL9H42mjf526lpPvtTtJ6Q",
    "sid": "c75b920cb40765e46db8276b08c8a539",
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491627,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-23 19:26:47.921 +05:30 [INF] End session request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "PostLogOutUri": "http://localhost/imagegallery/signout-callback-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu1jA0fWHH5XWne03f_2cbZOlA6-0uZUOm8akADnMKAwoTMpXrzM7MSoYEBJ1M94YO24mB2cIEXTf_z7hF2_oZWXkgQlVs_SNpOWkQ8SHRZ4Vh2HVM3DvJO8ztUxLfTUFg5EJefhBhZrrECuCVW-eb4Pz08K8WPxXtx-y6fe5-NWw",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost/imagegallery/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImJiZmM3OWE3YWVkNWNlYmU2NDRhM2JhNjM1NmE1YjZlIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ0OTE2MzUsImV4cCI6MTUyNDQ5MTkzNSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiSW1hZ2VHYWxsZXJ5LVdlYkFwcCIsIm5vbmNlIjoiNjM2NjAwODg0MjAwNjU2NDUxLlpEWTVaR1ExWWpjdE1XRXlZeTAwT1RJMExUazBNVGt0T0dJelkyRmxZV05tWkdKalltTXhZV015TUdFdE16TTVZUzAwWW1JMkxUZ3lPV1F0WXpjMk9UZzROelpqTWpBMyIsImlhdCI6MTUyNDQ5MTYzNSwiYXRfaGFzaCI6IkNMOUg0Mm1qZjUyNmxwUHZ0VHRKNlEiLCJzaWQiOiJjNzViOTIwY2I0MDc2NWU0NmRiODI3NmIwOGM4YTUzOSIsInN1YiI6ImQ4NjBlZmNhLTIyZDktNDdmZC04MjQ5LTc5MWJhNjFiMDdjNyIsImF1dGhfdGltZSI6MTUyNDQ5MTYyNywiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.pZpuV7n2tf_lD-u0pq4pEvtJognSmpHuZy_MKtfcKh4u6MNUoQctlfFzQ20HsF15UJZkBETX0u1DrIH2At4IFVleoyoh2kDGHRjaSvkm6iRa2K_-ReHSTSU8ilI1OFYFydoGb2rKoolkNRdilDS5awz93QLLKYaTDM3Y5Wpzz4ZZKf-UtQg7AuG4xyI4uvKGmISnJRRqxcaGSYQQwRGlNptNYNgDd9utBQNYTvarYh77NLbyZM0kGDzaAeYiwT8jqx_t5xlVoyB3qORv74ZlUdSB4YZb1gzAZ8mU9L5jmgJi5uALtDWhZDITh-oNHnT8tqJDtpXNtOgeafUqPNqsyg",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu1jA0fWHH5XWne03f_2cbZOlA6-0uZUOm8akADnMKAwoTMpXrzM7MSoYEBJ1M94YO24mB2cIEXTf_z7hF2_oZWXkgQlVs_SNpOWkQ8SHRZ4Vh2HVM3DvJO8ztUxLfTUFg5EJefhBhZrrECuCVW-eb4Pz08K8WPxXtx-y6fe5-NWw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:26:47.928 +05:30 [DBG] Success validating end session request from ImageGallery-WebApp
2018-04-23 19:26:47.975 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:26:47.980 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:26:48.048 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-04-23 19:26:48.342 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-23 19:26:48.364 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-23 19:26:48.367 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-23 19:26:48.380 +05:30 [DBG] Processing signout callback request
2018-04-23 19:26:48.684 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:48.685 +05:30 [DBG] No client front-channel logout URLs
2018-04-23 19:26:48.686 +05:30 [DBG] No client back-channel logout URLs
2018-04-23 19:26:48.686 +05:30 [INF] Successful signout callback.
2018-04-23 19:26:48.689 +05:30 [DBG] No client front-channel iframe urls
2018-04-23 19:26:48.689 +05:30 [DBG] No client back-channel iframe urls
2018-04-23 19:26:48.740 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 19:26:48.742 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 19:26:48.743 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 19:26:48.746 +05:30 [DBG] Start authorize request
2018-04-23 19:26:48.747 +05:30 [DBG] No user present in authorize request
2018-04-23 19:26:48.747 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:26:49.031 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:49.034 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:26:49.035 +05:30 [DBG] No PKCE used.
2018-04-23 19:26:49.100 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:26:49.309 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:26:49.375 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:26:49.641 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:26:49.643 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:26:49.644 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
  "Nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:26:49.650 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 19:26:49.701 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:26:50.074 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:50.076 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:26:50.077 +05:30 [DBG] No PKCE used.
2018-04-23 19:26:50.148 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:26:50.401 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:26:50.481 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:26:50.744 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:26:50.746 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:26:51.092 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:26:56.625 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:27:27.677 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:27:27.678 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 19:27:27.679 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 19:27:27.680 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:29:28.166 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:29:28.171 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:29:28.174 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:29:28.175 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:29:28.176 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:29:28.179 +05:30 [DBG] Start authorize callback request
2018-04-23 19:29:28.180 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:29:28.180 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:29:28.441 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:29:28.442 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:29:28.443 +05:30 [DBG] No PKCE used.
2018-04-23 19:29:28.493 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:29:28.676 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:29:28.726 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:29:28.909 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:29:28.912 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:29:28.913 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
  "Nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
  "SessionId": "2bf4d1fe14f48420c9de9ebfee8b2a96",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:29:28.959 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:29:28.960 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 19:29:28.979 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:29:28.984 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:29:29.017 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:29:29.336 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:29:29.338 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:29:29.338 +05:30 [DBG] No PKCE used.
2018-04-23 19:29:29.406 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:29:29.562 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:29:29.632 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:29:29.800 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:29:29.802 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:29:30.118 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:29:30.182 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:29:30.403 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:30:34.260 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:30:34.262 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:30:34.264 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:31:18.364 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:31:18.708 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:31:18.709 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:31:18.710 +05:30 [DBG] No PKCE used.
2018-04-23 19:31:18.777 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:31:19.011 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:31:19.077 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:31:19.244 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:31:19.246 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:33:08.801 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:33:08.805 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:33:08.808 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:33:08.809 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:33:08.810 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:33:08.812 +05:30 [DBG] Start authorize callback request
2018-04-23 19:33:08.814 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:33:08.814 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:33:09.065 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:09.066 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:33:09.067 +05:30 [DBG] No PKCE used.
2018-04-23 19:33:09.117 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:33:09.303 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:33:09.356 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:33:09.485 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:33:09.487 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:33:09.488 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
  "Nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
  "SessionId": "2bf4d1fe14f48420c9de9ebfee8b2a96",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:33:09.520 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:33:09.520 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 19:33:09.524 +05:30 [DBG] User indicated to remember consent for scopes: ["openid","profile","address","user-role","subscription","country","imagegallery-api","offline_access"]
2018-04-23 19:33:09.525 +05:30 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:33:09.558 +05:30 [DBG] jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= not found in database
2018-04-23 19:33:09.589 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 19:33:09.638 +05:30 [DBG] FQ3oAbTLjEYYHIlxdfLv00nqBRL55O3f6dIefKsNkfQ= not found in database
2018-04-23 19:33:09.675 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 19:33:09.675 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:33:09.677 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:33:09.684 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu3fVOGg8iC7Qkq6vdD08Eo2Pi4FHGK3NlXKCNkN-i3wIta4yMWLLQ7_yxNHxXD6bNu5ptnVKmdtqDLPIuwaVP0U44Iynh8hfLLJzhw6iooYsZNDK6cOh7XXgx7ROd6jvJveYrrrhz9jVi1WgNfAJM6moJLYE6JCD2a_zBLomJ-uqSTsQ5hsF847XVIiDwqDS9Zm3H8Y_LTAsRwX1GV_QOAtMg-RnbzMlMyE6jBTisqUlwqtOk-tFupTYCKwUaamkY-asDfr9sf-Kvb8P_VRdNUKnLQEZwHAIinp5myvsWX6nWcL2qFF--R7BNcQ84dhts",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 19:33:09.692 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:33:09.693 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:33:09.802 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:33:09.805 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:33:09.806 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:33:09.809 +05:30 [DBG] Start token request.
2018-04-23 19:33:09.809 +05:30 [DBG] Start client validation
2018-04-23 19:33:09.811 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:33:09.811 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:33:09.812 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:33:09.814 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:33:10.041 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:10.042 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:33:10.042 +05:30 [DBG] Client validation success
2018-04-23 19:33:10.043 +05:30 [DBG] Start token request validation
2018-04-23 19:33:10.043 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 19:33:10.069 +05:30 [DBG] FQ3oAbTLjEYYHIlxdfLv00nqBRL55O3f6dIefKsNkfQ= found in database: true
2018-04-23 19:33:10.106 +05:30 [DBG] removing FQ3oAbTLjEYYHIlxdfLv00nqBRL55O3f6dIefKsNkfQ= persisted grant from database
2018-04-23 19:33:10.157 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 19:33:10.158 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "d35d0e9f2179e5f3e6118081fc0f7dd96e4b9b47d3b51df22f5debd982bfb0b3",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "d35d0e9f2179e5f3e6118081fc0f7dd96e4b9b47d3b51df22f5debd982bfb0b3",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 19:33:10.383 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:10.436 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:33:10.638 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:33:10.640 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 19:33:10.640 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:33:10.727 +05:30 [DBG] +CkuOFPPcqp0/rXx6TEdmMDfoL4uDLyTrG7iYAPoKQs= not found in database
2018-04-23 19:33:10.759 +05:30 [DBG] Creating refresh token
2018-04-23 19:33:10.760 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 19:33:10.799 +05:30 [DBG] ozD0Gr2m5PbTvbk5IIlND1CLxurjTYw385g9OBTLvdc= not found in database
2018-04-23 19:33:11.048 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:11.100 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:33:11.219 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:33:11.221 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:33:11.221 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:33:11.225 +05:30 [DBG] Token request success.
2018-04-23 19:33:11.238 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 19:33:11.240 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 19:33:11.241 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 19:33:11.244 +05:30 [DBG] Start userinfo request
2018-04-23 19:33:11.244 +05:30 [DBG] Bearer token found in header
2018-04-23 19:33:11.270 +05:30 [DBG] +CkuOFPPcqp0/rXx6TEdmMDfoL4uDLyTrG7iYAPoKQs= found in database: true
2018-04-23 19:33:11.509 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:11.738 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:11.769 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:33:11.770 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "689587ac1dfa3cb58e927e8e8eb4d140e141a7c03c089166bc1edb0f0470195e",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492190,
    "exp": 1524492310,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:33:11.794 +05:30 [DBG] Creating userinfo response
2018-04-23 19:33:11.794 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:33:11.795 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:33:11.847 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:33:11.848 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 19:33:11.849 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:33:11.894 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:33:11.941 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 19:33:11.944 +05:30 [DBG] End userinfo request
2018-04-23 19:33:11.977 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:33:11.979 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:33:11.980 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:33:11.983 +05:30 [DBG] Starting introspection request.
2018-04-23 19:33:11.984 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:33:11.985 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:33:11.986 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:33:11.986 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:33:12.111 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:33:12.112 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:33:12.113 +05:30 [DBG] API resource validation success
2018-04-23 19:33:12.113 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:33:12.138 +05:30 [DBG] +CkuOFPPcqp0/rXx6TEdmMDfoL4uDLyTrG7iYAPoKQs= found in database: true
2018-04-23 19:33:12.379 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:12.605 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:33:12.634 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:33:12.636 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "689587ac1dfa3cb58e927e8e8eb4d140e141a7c03c089166bc1edb0f0470195e",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492190,
    "exp": 1524492310,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:33:12.638 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:33:12.639 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:33:12.639 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:37:54.610 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:37:54.613 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:37:54.614 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:37:54.617 +05:30 [DBG] Start discovery request
2018-04-23 19:37:54.792 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:37:54.816 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:37:54.818 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:37:54.819 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:37:54.821 +05:30 [DBG] Start key discovery request
2018-04-23 19:37:54.834 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:37:54.835 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:37:54.836 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:37:54.840 +05:30 [DBG] Start token request.
2018-04-23 19:37:54.841 +05:30 [DBG] Start client validation
2018-04-23 19:37:54.842 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:37:54.842 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:37:54.843 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:37:55.091 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:37:55.093 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:37:55.093 +05:30 [DBG] Client validation success
2018-04-23 19:37:55.094 +05:30 [DBG] Start token request validation
2018-04-23 19:37:55.094 +05:30 [DBG] Start validation of refresh token request
2018-04-23 19:37:55.122 +05:30 [DBG] ozD0Gr2m5PbTvbk5IIlND1CLxurjTYw385g9OBTLvdc= found in database: true
2018-04-23 19:37:55.162 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:37:55.165 +05:30 [DBG] Validation of refresh token request success
2018-04-23 19:37:55.165 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "RefreshToken": "a560ab5a404058ce1a0fd4f42ee985ce6c97ee906405a683abf76c82028f0b54",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "a560ab5a404058ce1a0fd4f42ee985ce6c97ee906405a683abf76c82028f0b54"
  }
}
2018-04-23 19:37:55.207 +05:30 [DBG] qj/2WS0I0kxOlE7jWWwE8J7kWrTXZ8DpBkYOghzJQEI= not found in database
2018-04-23 19:37:55.241 +05:30 [DBG] Updating refresh token
2018-04-23 19:37:55.241 +05:30 [DBG] Token usage is one-time only. Generating new handle
2018-04-23 19:37:55.269 +05:30 [DBG] removing ozD0Gr2m5PbTvbk5IIlND1CLxurjTYw385g9OBTLvdc= persisted grant from database
2018-04-23 19:37:55.330 +05:30 [DBG] SvsSQRO0q7Oxg447nmoilgYhjr/tFkeoq0nH/XCCITQ= not found in database
2018-04-23 19:37:55.358 +05:30 [DBG] Created refresh token in store
2018-04-23 19:37:55.416 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:37:55.605 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:37:55.652 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:37:55.788 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:37:55.789 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:37:55.790 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:37:55.795 +05:30 [DBG] Token request success.
2018-04-23 19:37:55.816 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:37:55.818 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:37:55.818 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:37:55.821 +05:30 [DBG] Starting introspection request.
2018-04-23 19:37:55.821 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:37:55.822 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:37:55.822 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:37:55.823 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:37:55.942 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:37:55.943 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:37:55.944 +05:30 [DBG] API resource validation success
2018-04-23 19:37:55.944 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:37:55.969 +05:30 [DBG] qj/2WS0I0kxOlE7jWWwE8J7kWrTXZ8DpBkYOghzJQEI= found in database: true
2018-04-23 19:37:56.205 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:37:56.431 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:37:56.455 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:37:56.457 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "a62d5e3db79ff6f7f8a482b0d989a78168303256646fd7b226e383c21799fb8a",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492475,
    "exp": 1524492595,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:37:56.459 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:37:56.459 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:37:56.459 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:37:58.421 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:37:58.425 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:37:58.426 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:37:58.429 +05:30 [DBG] Starting introspection request.
2018-04-23 19:37:58.429 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:37:58.429 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:37:58.430 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:37:58.430 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:37:58.543 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:37:58.545 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:37:58.545 +05:30 [DBG] API resource validation success
2018-04-23 19:37:58.545 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:37:58.570 +05:30 [DBG] qj/2WS0I0kxOlE7jWWwE8J7kWrTXZ8DpBkYOghzJQEI= found in database: true
2018-04-23 19:37:58.815 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:37:59.045 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:37:59.081 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:37:59.083 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "a62d5e3db79ff6f7f8a482b0d989a78168303256646fd7b226e383c21799fb8a",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492475,
    "exp": 1524492595,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:37:59.085 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:37:59.086 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:37:59.086 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:42:32.842 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:42:32.876 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:42:32.876 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:42:32.876 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:42:32.876 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:42:36.240 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:42:36.247 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:42:36.248 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:42:36.255 +05:30 [DBG] Start discovery request
2018-04-23 19:42:37.455 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:42:37.596 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:42:37.620 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:42:37.622 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:42:37.629 +05:30 [DBG] Start key discovery request
2018-04-23 19:42:37.860 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:42:37.872 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:42:37.872 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:42:37.883 +05:30 [DBG] Start token request.
2018-04-23 19:42:37.890 +05:30 [DBG] Start client validation
2018-04-23 19:42:37.897 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:42:37.898 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:42:37.898 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:42:38.450 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:38.467 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:42:38.467 +05:30 [DBG] Client validation success
2018-04-23 19:42:38.515 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94H1PJ6Q6:00000001",
  "TimeStamp": "2018-04-23T14:12:38Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:38.541 +05:30 [DBG] Start token request validation
2018-04-23 19:42:38.553 +05:30 [DBG] Start validation of refresh token request
2018-04-23 19:42:38.633 +05:30 [DBG] SvsSQRO0q7Oxg447nmoilgYhjr/tFkeoq0nH/XCCITQ= found in database: true
2018-04-23 19:42:38.737 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:42:38.740 +05:30 [DBG] Validation of refresh token request success
2018-04-23 19:42:38.750 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "RefreshToken": "59fe2434bd30e98f4297f94b3fd9cadbee6356f28d364ab33f1257b0024a6f5a",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "59fe2434bd30e98f4297f94b3fd9cadbee6356f28d364ab33f1257b0024a6f5a"
  }
}
2018-04-23 19:42:38.822 +05:30 [DBG] hc8dsMWKOdtQ5LBGDDMZgIZ4k5hxD8fp/F3bNacyIPQ= not found in database
2018-04-23 19:42:38.893 +05:30 [DBG] Updating refresh token
2018-04-23 19:42:38.894 +05:30 [DBG] Token usage is one-time only. Generating new handle
2018-04-23 19:42:38.926 +05:30 [DBG] removing SvsSQRO0q7Oxg447nmoilgYhjr/tFkeoq0nH/XCCITQ= persisted grant from database
2018-04-23 19:42:38.996 +05:30 [DBG] 3hbjvvx7DzPTrCt87cI10gSZKCu3G7HMopQYeVDHw2A= not found in database
2018-04-23 19:42:39.028 +05:30 [DBG] Created refresh token in store
2018-04-23 19:42:39.107 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:42:39.335 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:42:39.390 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:42:39.516 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:42:39.528 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:42:39.531 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:42:39.604 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "Endpoint": "Token",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "Scopes": "openid profile address user-role country subscription imagegallery-api offline_access",
  "GrantType": "refresh_token",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****pYsA"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****e42d"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****fa75"
    }
  ],
  "ActivityId": "0HLD94H1PJ6Q6:00000001",
  "TimeStamp": "2018-04-23T14:12:39Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:39.611 +05:30 [DBG] Token request success.
2018-04-23 19:42:41.607 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:42:41.609 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:42:41.610 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:42:41.613 +05:30 [DBG] Start discovery request
2018-04-23 19:42:41.762 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:42:41.797 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:42:41.800 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:42:41.801 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:42:41.804 +05:30 [DBG] Start key discovery request
2018-04-23 19:42:42.010 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:42:42.014 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:42:42.015 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:42:42.026 +05:30 [DBG] Starting introspection request.
2018-04-23 19:42:42.033 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:42:42.036 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:42:42.039 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:42:42.039 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:42:42.214 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:42:42.216 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:42:42.216 +05:30 [DBG] API resource validation success
2018-04-23 19:42:42.221 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94H1PJ6Q8:00000001",
  "TimeStamp": "2018-04-23T14:12:42Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:42.231 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:42:42.275 +05:30 [DBG] hc8dsMWKOdtQ5LBGDDMZgIZ4k5hxD8fp/F3bNacyIPQ= found in database: true
2018-04-23 19:42:42.523 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:42.743 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:42.770 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:42:42.772 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "feca8ed43a2c766756838c9ac6ca7d89100a9d69343f7e4b9804cd820fd9fa75",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492758,
    "exp": 1524492878,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:42:42.774 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:42:42.785 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:42:42.795 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****fa75",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD94H1PJ6Q8:00000001",
  "TimeStamp": "2018-04-23T14:12:42Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:42.802 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:42:48.546 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:42:48.548 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:42:48.549 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:42:48.551 +05:30 [DBG] Start discovery request
2018-04-23 19:42:48.698 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:42:48.710 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:42:48.711 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:42:48.712 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:42:48.716 +05:30 [DBG] Start key discovery request
2018-04-23 19:42:48.738 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:42:48.742 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:42:48.743 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:42:48.754 +05:30 [DBG] Start revocation request.
2018-04-23 19:42:48.755 +05:30 [DBG] Start client validation
2018-04-23 19:42:48.755 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:42:48.756 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:42:48.756 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:42:48.980 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:48.982 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:42:48.982 +05:30 [DBG] Client validation success
2018-04-23 19:42:48.983 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94H1PJ6QA:00000001",
  "TimeStamp": "2018-04-23T14:12:48Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:48.988 +05:30 [DBG] Token type hint found in request: access_token
2018-04-23 19:42:48.989 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:42:49.025 +05:30 [DBG] hc8dsMWKOdtQ5LBGDDMZgIZ4k5hxD8fp/F3bNacyIPQ= found in database: true
2018-04-23 19:42:49.036 +05:30 [DBG] Access token revoked
2018-04-23 19:42:49.059 +05:30 [DBG] removing hc8dsMWKOdtQ5LBGDDMZgIZ4k5hxD8fp/F3bNacyIPQ= persisted grant from database
2018-04-23 19:42:49.087 +05:30 [INF] Token successfully revoked
2018-04-23 19:42:49.096 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "access_token",
  "Token": "****fa75",
  "ActivityId": "0HLD94H1PJ6QA:00000001",
  "TimeStamp": "2018-04-23T14:12:49Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:49.117 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:42:49.121 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:42:49.129 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:42:49.140 +05:30 [DBG] Start revocation request.
2018-04-23 19:42:49.141 +05:30 [DBG] Start client validation
2018-04-23 19:42:49.142 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:42:49.142 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:42:49.144 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:42:49.376 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:49.377 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:42:49.377 +05:30 [DBG] Client validation success
2018-04-23 19:42:49.378 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94H1PJ6QA:00000002",
  "TimeStamp": "2018-04-23T14:12:49Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:49.381 +05:30 [DBG] Token type hint found in request: refresh_token
2018-04-23 19:42:49.381 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:42:49.413 +05:30 [DBG] 3hbjvvx7DzPTrCt87cI10gSZKCu3G7HMopQYeVDHw2A= found in database: true
2018-04-23 19:42:49.427 +05:30 [DBG] Refresh token revoked
2018-04-23 19:42:49.450 +05:30 [DBG] removing 3hbjvvx7DzPTrCt87cI10gSZKCu3G7HMopQYeVDHw2A= persisted grant from database
2018-04-23 19:42:49.515 +05:30 [DBG] removing 2 persisted grants from database for subject d860efca-22d9-47fd-8249-791ba61b07c7, clientId ImageGallery-WebApp, grantType reference_token
2018-04-23 19:42:49.549 +05:30 [INF] Token successfully revoked
2018-04-23 19:42:49.552 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "refresh_token",
  "Token": "****e42d",
  "ActivityId": "0HLD94H1PJ6QA:00000002",
  "TimeStamp": "2018-04-23T14:12:49Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:49.583 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:42:49.586 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:42:49.588 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:42:49.591 +05:30 [DBG] Start discovery request
2018-04-23 19:42:49.735 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:42:49.793 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:42:49.795 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:42:49.796 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:42:49.798 +05:30 [DBG] Start key discovery request
2018-04-23 19:42:49.838 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:42:49.843 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:42:49.846 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-23 19:42:49.849 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-23 19:42:49.849 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-23 19:42:49.861 +05:30 [DBG] Processing signout request for d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:42:49.868 +05:30 [DBG] Start end session request validation
2018-04-23 19:42:49.875 +05:30 [DBG] Start identity token validation
2018-04-23 19:42:50.118 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:50.120 +05:30 [DBG] Client found: ImageGallery-WebApp / Image Gallery
2018-04-23 19:42:50.187 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:42:50.190 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524492191,
    "exp": 1524492491,
    "iss": "http://localhost:5000",
    "aud": "ImageGallery-WebApp",
    "nonce": "636600886087333290.YWVkYjI5NWYtM2FmNC00MDAxLTkzYmItYmJhNmRmMDRiYTUzMDQzZDNlYTQtMDdmMi00YjgyLWJlM2ItNGQ3ZGNhNGU1YmJl",
    "iat": 1524492191,
    "at_hash": "1_HrBrAW5FEu6xswVEwFVw",
    "sid": "2bf4d1fe14f48420c9de9ebfee8b2a96",
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524491847,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-23 19:42:50.205 +05:30 [INF] End session request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "PostLogOutUri": "http://localhost/imagegallery/signout-callback-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu43RGjWNGNjSn0kBBACdipnRSnpAyIpzbqSi_2kHNFAOvpeTV_J-R2-LxGdsPpqg8vpW8w94OcKvhyqEQXr2ihGRLO_h9mCc38qF2qfgEmWxlKKnGpfCHXJtEBtU3aBainzJvMm-LcMxTUj0Ctet4HmEc85p1zsjothlTZyX9zVg",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost/imagegallery/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImJiZmM3OWE3YWVkNWNlYmU2NDRhM2JhNjM1NmE1YjZlIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ0OTIxOTEsImV4cCI6MTUyNDQ5MjQ5MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiSW1hZ2VHYWxsZXJ5LVdlYkFwcCIsIm5vbmNlIjoiNjM2NjAwODg2MDg3MzMzMjkwLllXVmtZakk1TldZdE0yRm1OQzAwTURBeExUa3pZbUl0WW1KaE5tUm1NRFJpWVRVek1EUXpaRE5sWVRRdE1EZG1NaTAwWWpneUxXSmxNMkl0TkdRM1pHTmhOR1UxWW1KbCIsImlhdCI6MTUyNDQ5MjE5MSwiYXRfaGFzaCI6IjFfSHJCckFXNUZFdTZ4c3dWRXdGVnciLCJzaWQiOiIyYmY0ZDFmZTE0ZjQ4NDIwYzlkZTllYmZlZThiMmE5NiIsInN1YiI6ImQ4NjBlZmNhLTIyZDktNDdmZC04MjQ5LTc5MWJhNjFiMDdjNyIsImF1dGhfdGltZSI6MTUyNDQ5MTg0NywiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.Arj_f6HcrpgHxQ8ocHrEzN3zBuJKRPw7UnDa8PkbcnwpvkNG8K2GZX3jv47R9Mo215XHOExySMvCrAypg8XfhqzvQJ4WgBgUeYeyQtSckh1SdZLEBhRsbi8GrLiTxD-EbE9Hj5D6zqcjiHJJenfSbDYDpVapn9O1RGjqQPr23eu3eNKJqAtwz86T1XT7QD7MAWDJ5qUkUZY3xQcUq6w_Qzzozo7gnk3wAqf-glviaI04weCUygmIUp7IgYoTYiAwaLt52PCBfKwtzE7oQM4wLAJPE29kz0wD8EXgRd7Dfvu3TRaoirR2E0PtItOCc79dFHe0fDtnlFj7lldt-qN5JA",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqu43RGjWNGNjSn0kBBACdipnRSnpAyIpzbqSi_2kHNFAOvpeTV_J-R2-LxGdsPpqg8vpW8w94OcKvhyqEQXr2ihGRLO_h9mCc38qF2qfgEmWxlKKnGpfCHXJtEBtU3aBainzJvMm-LcMxTUj0Ctet4HmEc85p1zsjothlTZyX9zVg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:42:50.226 +05:30 [DBG] Success validating end session request from ImageGallery-WebApp
2018-04-23 19:42:50.263 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:42:50.266 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:42:50.616 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-04-23 19:42:50.627 +05:30 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "ActivityId": "0HLD94H1PJ6QC:00000002",
  "TimeStamp": "2018-04-23T14:12:50Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:42:53.643 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-23 19:42:53.668 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-23 19:42:53.670 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-23 19:42:53.683 +05:30 [DBG] Processing signout callback request
2018-04-23 19:42:53.942 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:53.943 +05:30 [DBG] No client front-channel logout URLs
2018-04-23 19:42:53.944 +05:30 [DBG] No client back-channel logout URLs
2018-04-23 19:42:53.944 +05:30 [INF] Successful signout callback.
2018-04-23 19:42:53.946 +05:30 [DBG] No client front-channel iframe urls
2018-04-23 19:42:53.946 +05:30 [DBG] No client back-channel iframe urls
2018-04-23 19:42:54.009 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 19:42:54.015 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 19:42:54.016 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 19:42:54.022 +05:30 [DBG] Start authorize request
2018-04-23 19:42:54.031 +05:30 [DBG] No user present in authorize request
2018-04-23 19:42:54.040 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:42:54.287 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:54.293 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:42:54.296 +05:30 [DBG] No PKCE used.
2018-04-23 19:42:54.364 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:42:54.572 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:42:54.632 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:42:54.760 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:42:54.772 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:42:54.783 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
  "Nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:42:54.800 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 19:42:54.867 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:42:55.200 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:55.202 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:42:55.202 +05:30 [DBG] No PKCE used.
2018-04-23 19:42:55.271 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:42:55.445 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:42:55.513 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:42:55.684 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:42:55.685 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:42:55.988 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:42:59.508 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:43:01.579 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94H1PJ6QC:00000006",
  "TimeStamp": "2018-04-23T14:13:01Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:43:01.599 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:43:01.602 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 19:43:01.602 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 19:43:01.610 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:43:01.631 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:01.635 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:01.637 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:43:01.639 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:43:01.640 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:43:01.648 +05:30 [DBG] Start authorize callback request
2018-04-23 19:43:01.652 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:43:01.653 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:43:01.880 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:01.881 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:43:01.882 +05:30 [DBG] No PKCE used.
2018-04-23 19:43:01.927 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:02.044 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:02.091 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:02.208 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:02.210 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:43:02.210 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
  "Nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
  "SessionId": "1542a27d4eb800fecda7dd2ae8007225",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:43:02.250 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:43:02.250 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 19:43:02.267 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:02.270 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:02.319 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:43:02.658 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:02.660 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:43:02.661 +05:30 [DBG] No PKCE used.
2018-04-23 19:43:02.728 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:02.892 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:02.981 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:03.147 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:03.148 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:43:03.440 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:03.507 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:03.729 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:10.149 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:43:10.151 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:10.155 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:12.335 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:43:12.694 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:12.696 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:43:12.696 +05:30 [DBG] No PKCE used.
2018-04-23 19:43:12.776 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:13.040 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:13.114 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:13.383 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:13.385 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:43:13.426 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:13.430 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:43:13.433 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:43:13.434 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:43:13.435 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:43:13.440 +05:30 [DBG] Start authorize callback request
2018-04-23 19:43:13.447 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:43:13.448 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:43:13.729 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:13.731 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:43:13.731 +05:30 [DBG] No PKCE used.
2018-04-23 19:43:13.783 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:13.984 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:14.040 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:14.253 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:14.254 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:43:14.255 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
  "Nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
  "SessionId": "1542a27d4eb800fecda7dd2ae8007225",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:43:14.292 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:43:14.300 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 19:43:14.310 +05:30 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:43:14.355 +05:30 [DBG] removing jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= persisted grant from database
2018-04-23 19:43:14.393 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 19:43:14.442 +05:30 [DBG] zs2nCwaR+F2snUS/fPRrgG6iuJPo64l1k4VocvCGRqE= not found in database
2018-04-23 19:43:14.486 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 19:43:14.489 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:43:14.490 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:43:14.511 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****BAEw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****aeed"
    }
  ],
  "ActivityId": "0HLD94H1PJ6QC:0000000A",
  "TimeStamp": "2018-04-23T14:13:14Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:43:14.525 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqs-mqiHUgEvoz-OCC7z5BSdWQXw5sAJkBS41Nkzz-xyUaOa-6rWDAeTj_1_DF7Qqqv-5jEAJj3czZPDpchS4Kjje5NPPTEz_iJKnjG-OCswZapfA-wwfbzehXzASkinwG2K5BiCyk1K2FmrMN1_5B29VMvfPdZqrdFY6esgvGJXWH0O94hS4gp1cnskOxwtsYoA0OMpXX01eo95yNRh9i2kj3yfhiq40pRoR8pZPSTHoMKbtg7djWn6y8C6kbVYL_CBoNgnfjTfRKXMl9LLGNjGEcZ0HOuzyioLNgkDjN-x6A8NyEn4_Zo-vUvp2YVi0ls",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 19:43:14.550 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:43:14.551 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:43:14.717 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:43:14.721 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:43:14.723 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:43:14.733 +05:30 [DBG] Start token request.
2018-04-23 19:43:14.735 +05:30 [DBG] Start client validation
2018-04-23 19:43:14.736 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:43:14.737 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:43:14.743 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:43:14.745 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:43:14.992 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:14.995 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:43:14.997 +05:30 [DBG] Client validation success
2018-04-23 19:43:15.002 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94H1PJ6QB:00000003",
  "TimeStamp": "2018-04-23T14:13:15Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:43:15.013 +05:30 [DBG] Start token request validation
2018-04-23 19:43:15.023 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 19:43:15.055 +05:30 [DBG] zs2nCwaR+F2snUS/fPRrgG6iuJPo64l1k4VocvCGRqE= found in database: true
2018-04-23 19:43:15.095 +05:30 [DBG] removing zs2nCwaR+F2snUS/fPRrgG6iuJPo64l1k4VocvCGRqE= persisted grant from database
2018-04-23 19:43:15.147 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 19:43:15.148 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "ed7d624c8678aebc0b10c5a2220b29826eaa308823f6db6dc1d78a73127aaeed",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "ed7d624c8678aebc0b10c5a2220b29826eaa308823f6db6dc1d78a73127aaeed",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 19:43:15.428 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:15.489 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:15.700 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:15.714 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 19:43:15.715 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:43:15.884 +05:30 [DBG] degAsxnNxfD23DH4WXSZdBGFCgwsgWfBj7nWHIo/oaM= not found in database
2018-04-23 19:43:15.917 +05:30 [DBG] Creating refresh token
2018-04-23 19:43:15.917 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 19:43:15.966 +05:30 [DBG] IzvaZ6c4QncLQabzVSM6/w00uwlgFuTjvd/stfkat9s= not found in database
2018-04-23 19:43:16.260 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:16.314 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:16.518 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:43:16.519 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:43:16.521 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:43:16.527 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "Endpoint": "Token",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****C6oQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****035a"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****c445"
    }
  ],
  "ActivityId": "0HLD94H1PJ6QB:00000003",
  "TimeStamp": "2018-04-23T14:13:16Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:43:16.534 +05:30 [DBG] Token request success.
2018-04-23 19:43:16.555 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 19:43:16.559 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 19:43:16.561 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 19:43:16.573 +05:30 [DBG] Start userinfo request
2018-04-23 19:43:16.579 +05:30 [DBG] Bearer token found in header
2018-04-23 19:43:16.621 +05:30 [DBG] degAsxnNxfD23DH4WXSZdBGFCgwsgWfBj7nWHIo/oaM= found in database: true
2018-04-23 19:43:16.872 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:17.099 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:17.127 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:43:17.130 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "1a4968f79b85532d77ce8b8dabf2532ef012e49c5584b04ac397ff582e67c445",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492795,
    "exp": 1524492915,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524492781,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:43:17.164 +05:30 [DBG] Creating userinfo response
2018-04-23 19:43:17.169 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:43:17.175 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:43:17.238 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:17.240 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 19:43:17.241 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:43:17.289 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:43:17.336 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 19:43:17.339 +05:30 [DBG] End userinfo request
2018-04-23 19:43:17.385 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:43:17.387 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:43:17.388 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:43:17.390 +05:30 [DBG] Starting introspection request.
2018-04-23 19:43:17.391 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:43:17.391 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:43:17.392 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:43:17.392 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:43:17.522 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:43:17.524 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:43:17.524 +05:30 [DBG] API resource validation success
2018-04-23 19:43:17.525 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94H1PJ6Q8:00000002",
  "TimeStamp": "2018-04-23T14:13:17Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:43:17.529 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:43:17.556 +05:30 [DBG] degAsxnNxfD23DH4WXSZdBGFCgwsgWfBj7nWHIo/oaM= found in database: true
2018-04-23 19:43:17.793 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:18.017 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:43:18.042 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:43:18.044 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "1a4968f79b85532d77ce8b8dabf2532ef012e49c5584b04ac397ff582e67c445",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524492795,
    "exp": 1524492915,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524492781,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:43:18.046 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:43:18.046 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:43:18.047 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****c445",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD94H1PJ6Q8:00000002",
  "TimeStamp": "2018-04-23T14:13:18Z",
  "ProcessId": 20136,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:43:18.049 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:47:16.122 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:47:16.157 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:47:16.157 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:47:16.157 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:47:16.158 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:47:21.807 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:47:21.813 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:47:21.814 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:47:21.820 +05:30 [DBG] Start discovery request
2018-04-23 19:47:22.998 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:47:23.174 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:47:23.177 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:47:23.178 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:47:23.185 +05:30 [DBG] Start key discovery request
2018-04-23 19:47:23.432 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:47:23.439 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:47:23.440 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:47:23.455 +05:30 [DBG] Start revocation request.
2018-04-23 19:47:23.464 +05:30 [DBG] Start client validation
2018-04-23 19:47:23.470 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:47:23.471 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:47:23.471 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:47:24.012 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:24.027 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:47:24.027 +05:30 [DBG] Client validation success
2018-04-23 19:47:24.071 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94JMSTMTA:00000001",
  "TimeStamp": "2018-04-23T14:17:24Z",
  "ProcessId": 42096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:47:24.093 +05:30 [DBG] Token type hint found in request: access_token
2018-04-23 19:47:24.093 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:47:24.167 +05:30 [DBG] degAsxnNxfD23DH4WXSZdBGFCgwsgWfBj7nWHIo/oaM= found in database: true
2018-04-23 19:47:24.206 +05:30 [DBG] Access token revoked
2018-04-23 19:47:24.233 +05:30 [DBG] removing degAsxnNxfD23DH4WXSZdBGFCgwsgWfBj7nWHIo/oaM= persisted grant from database
2018-04-23 19:47:24.295 +05:30 [INF] Token successfully revoked
2018-04-23 19:47:24.305 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "access_token",
  "Token": "****c445",
  "ActivityId": "0HLD94JMSTMTA:00000001",
  "TimeStamp": "2018-04-23T14:17:24Z",
  "ProcessId": 42096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:47:24.323 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:47:24.325 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:47:24.327 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:47:24.330 +05:30 [DBG] Start revocation request.
2018-04-23 19:47:24.331 +05:30 [DBG] Start client validation
2018-04-23 19:47:24.331 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:47:24.332 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:47:24.332 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:47:24.547 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:24.549 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:47:24.549 +05:30 [DBG] Client validation success
2018-04-23 19:47:24.550 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94JMSTMTA:00000002",
  "TimeStamp": "2018-04-23T14:17:24Z",
  "ProcessId": 42096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:47:24.553 +05:30 [DBG] Token type hint found in request: refresh_token
2018-04-23 19:47:24.554 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:47:24.584 +05:30 [DBG] IzvaZ6c4QncLQabzVSM6/w00uwlgFuTjvd/stfkat9s= found in database: true
2018-04-23 19:47:24.597 +05:30 [DBG] Refresh token revoked
2018-04-23 19:47:24.620 +05:30 [DBG] removing IzvaZ6c4QncLQabzVSM6/w00uwlgFuTjvd/stfkat9s= persisted grant from database
2018-04-23 19:47:24.682 +05:30 [DBG] removing 0 persisted grants from database for subject d860efca-22d9-47fd-8249-791ba61b07c7, clientId ImageGallery-WebApp, grantType reference_token
2018-04-23 19:47:24.685 +05:30 [INF] Token successfully revoked
2018-04-23 19:47:24.688 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "refresh_token",
  "Token": "****035a",
  "ActivityId": "0HLD94JMSTMTA:00000002",
  "TimeStamp": "2018-04-23T14:17:24Z",
  "ProcessId": 42096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:47:24.716 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:47:24.719 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:47:24.720 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:47:24.723 +05:30 [DBG] Start discovery request
2018-04-23 19:47:24.872 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:47:24.936 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:47:24.937 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:47:24.939 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:47:24.942 +05:30 [DBG] Start key discovery request
2018-04-23 19:47:25.002 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:47:25.007 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:47:25.011 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-23 19:47:25.017 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-23 19:47:25.017 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-23 19:47:25.031 +05:30 [DBG] Processing signout request for d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:47:25.040 +05:30 [DBG] Start end session request validation
2018-04-23 19:47:25.048 +05:30 [DBG] Start identity token validation
2018-04-23 19:47:25.294 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:25.296 +05:30 [DBG] Client found: ImageGallery-WebApp / Image Gallery
2018-04-23 19:47:25.418 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:47:25.424 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524492796,
    "exp": 1524493096,
    "iss": "http://localhost:5000",
    "aud": "ImageGallery-WebApp",
    "nonce": "636600895740028979.ZWEwYThjODctMzhiMS00ZDY1LTlkYjUtZTFlZTk4YWRjYjBkYzg4ZjhkZDQtZjc0Zi00YmE1LTkwMzktMmI4MGZlYTJlZjM5",
    "iat": 1524492796,
    "at_hash": "RIrZeajPdrmP2tolhoSplg",
    "sid": "1542a27d4eb800fecda7dd2ae8007225",
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524492781,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-23 19:47:25.442 +05:30 [INF] End session request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "PostLogOutUri": "http://localhost/imagegallery/signout-callback-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqvS3OFFlMztxFZrEU3NXATXVMjIt0WJbkIQjUf9VsHlc0_XBxDxi3n5GwA9s5tRZiXGP-dHNqdlQnkn0HHDkYDzkdF2YJrORmD2Ircf-8WScJWIWlzEN-RVPaxB9qoM1M9DFjmCTzBE0CZFeVJmGuiJF3x0iVdvoFkRbKa4UBtm_A",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost/imagegallery/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImJiZmM3OWE3YWVkNWNlYmU2NDRhM2JhNjM1NmE1YjZlIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ0OTI3OTYsImV4cCI6MTUyNDQ5MzA5NiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiSW1hZ2VHYWxsZXJ5LVdlYkFwcCIsIm5vbmNlIjoiNjM2NjAwODk1NzQwMDI4OTc5LlpXRXdZVGhqT0RjdE16aGlNUzAwWkRZMUxUbGtZalV0WlRGbFpUazRZV1JqWWpCa1l6ZzRaamhrWkRRdFpqYzBaaTAwWW1FMUxUa3dNemt0TW1JNE1HWmxZVEpsWmpNNSIsImlhdCI6MTUyNDQ5Mjc5NiwiYXRfaGFzaCI6IlJJclplYWpQZHJtUDJ0b2xob1NwbGciLCJzaWQiOiIxNTQyYTI3ZDRlYjgwMGZlY2RhN2RkMmFlODAwNzIyNSIsInN1YiI6ImQ4NjBlZmNhLTIyZDktNDdmZC04MjQ5LTc5MWJhNjFiMDdjNyIsImF1dGhfdGltZSI6MTUyNDQ5Mjc4MSwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.Y9KOYiphGDHvUyaB-5oKruAK3xzP1uE_KL8sS803r73oxGav8PkF2pPJDpIEzDuqu7Q_E_K-9aUDPtEysNHuSWG7Emsv0RAi5NbqKiB0rR71Gdyqv6raNzQ1_zvGf2vPn1zmudp3R6odGhoj_c9oStruiASnM8_ydfqhGxWhq5ZfE8LCD0k5ZhiNthId3A0ciZn-gzeKsXeKzdqDDGJ9R2oDhP3nqSfYougO_u5G7fe0OU2OLCbS0Gzw10yOBLvtJSxalNiMBN2ZrKvU61ekHGW_NePiQ8_wnFIDRoA-45R_CtFKfWl2J3MtJNCYn4uixTPvmucY6XlaInCsEpC6oQ",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqvS3OFFlMztxFZrEU3NXATXVMjIt0WJbkIQjUf9VsHlc0_XBxDxi3n5GwA9s5tRZiXGP-dHNqdlQnkn0HHDkYDzkdF2YJrORmD2Ircf-8WScJWIWlzEN-RVPaxB9qoM1M9DFjmCTzBE0CZFeVJmGuiJF3x0iVdvoFkRbKa4UBtm_A",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:47:25.451 +05:30 [DBG] Success validating end session request from ImageGallery-WebApp
2018-04-23 19:47:25.484 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:47:25.487 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:47:25.813 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-04-23 19:47:25.823 +05:30 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "ActivityId": "0HLD94JMSTMTC:00000002",
  "TimeStamp": "2018-04-23T14:17:25Z",
  "ProcessId": 42096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:47:30.307 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-23 19:47:30.331 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-23 19:47:30.334 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-23 19:47:30.348 +05:30 [DBG] Processing signout callback request
2018-04-23 19:47:30.662 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:30.664 +05:30 [DBG] No client front-channel logout URLs
2018-04-23 19:47:30.664 +05:30 [DBG] No client back-channel logout URLs
2018-04-23 19:47:30.664 +05:30 [INF] Successful signout callback.
2018-04-23 19:47:30.666 +05:30 [DBG] No client front-channel iframe urls
2018-04-23 19:47:30.667 +05:30 [DBG] No client back-channel iframe urls
2018-04-23 19:47:30.781 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 19:47:30.788 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 19:47:30.789 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 19:47:30.801 +05:30 [DBG] Start authorize request
2018-04-23 19:47:30.808 +05:30 [DBG] No user present in authorize request
2018-04-23 19:47:30.818 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:47:31.075 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:31.083 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:47:31.085 +05:30 [DBG] No PKCE used.
2018-04-23 19:47:31.191 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:47:31.445 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:47:31.508 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:47:31.634 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:47:31.648 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:47:31.659 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
  "Nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:47:31.681 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 19:47:31.752 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:47:32.083 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:32.084 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:47:32.084 +05:30 [DBG] No PKCE used.
2018-04-23 19:47:32.156 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:47:32.329 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:47:32.406 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:47:32.568 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:47:32.570 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:47:32.874 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:47:36.469 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:47:38.890 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94JMSTMTC:00000006",
  "TimeStamp": "2018-04-23T14:17:38Z",
  "ProcessId": 42096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:48:40.348 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:48:40.380 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:48:40.381 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:48:40.381 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:48:40.382 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:48:47.534 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:48:48.489 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:48:48.499 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:48:48.501 +05:30 [DBG] No PKCE used.
2018-04-23 19:48:48.566 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:48.795 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:48:48.819 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:48.824 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:48:48.837 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:48:48.845 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:48:56.263 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:48:56.461 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94KGDKC1V:00000002",
  "TimeStamp": "2018-04-23T14:18:56Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:48:56.475 +05:30 [INF] {
  "Name": "name",
  "Category": "test",
  "EventType": "Success",
  "Id": 1,
  "Message": "loginsuccess",
  "ActivityId": "0HLD94KGDKC1V:00000002",
  "TimeStamp": "2018-04-23T14:18:56Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:48:56.493 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:48:56.499 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 19:48:56.499 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 19:48:56.511 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:48:56.525 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:48:56.527 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:48:56.528 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:48:56.534 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:48:56.535 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:48:56.542 +05:30 [DBG] Start authorize callback request
2018-04-23 19:48:56.554 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:48:56.554 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:48:56.563 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:48:56.563 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:48:56.564 +05:30 [DBG] No PKCE used.
2018-04-23 19:48:56.566 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:56.570 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:48:56.572 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:56.577 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:48:56.578 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:48:56.610 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
  "Nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
  "SessionId": "005770964838210cc48e8c5def1df8a0",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:48:56.638 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:48:56.639 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 19:48:56.653 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:48:56.654 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:48:56.671 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:48:56.676 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:48:56.677 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:48:56.678 +05:30 [DBG] No PKCE used.
2018-04-23 19:48:56.680 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:56.684 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:48:56.685 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:56.688 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:48:56.688 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:48:56.694 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:48:56.701 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:48:56.779 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.059 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:49:02.061 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:49:02.062 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:49:02.082 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:49:02.088 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:02.090 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:49:02.090 +05:30 [DBG] No PKCE used.
2018-04-23 19:49:02.094 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:02.098 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.100 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:02.104 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.104 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:49:02.133 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:49:02.135 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:49:02.136 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 19:49:02.137 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 19:49:02.138 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 19:49:02.139 +05:30 [DBG] Start authorize callback request
2018-04-23 19:49:02.167 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:49:02.168 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:49:02.175 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:02.176 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:49:02.176 +05:30 [DBG] No PKCE used.
2018-04-23 19:49:02.179 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:02.183 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.185 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:02.188 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.189 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:49:02.190 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
  "Nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
  "SessionId": "005770964838210cc48e8c5def1df8a0",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:49:02.195 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 19:49:02.201 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 19:49:02.206 +05:30 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:49:02.231 +05:30 [DBG] no jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= persisted grant found in database
2018-04-23 19:49:02.239 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 19:49:02.273 +05:30 [DBG] Ds4tRpWBt91bbW+KmDrXxyHV2FxnUor1K4UDqVQI98g= not found in database
2018-04-23 19:49:02.324 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 19:49:02.334 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:49:02.337 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:49:02.405 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****jv0w"
    },
    {
      "TokenType": "code",
      "TokenValue": "****ce30"
    }
  ],
  "ActivityId": "0HLD94KGDKC20:00000002",
  "TimeStamp": "2018-04-23T14:19:02Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:49:02.413 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsnEtjdlkeJCuQyuMzKYLjd4QbttslkqPoZWa-AGwMHSLVPfajyXcE2ewBdfqSPdAgyIOux7YufM8aqt_5G-Lg6302Qgx1jr3ywX0UdvaITjBjGX4TtnFsDzkrArt3hh0WumgrNePseuP3W4RNK4YEOsM66i6ErD9yoJkJ_vCmyhO8TRSNRs63NbppZwd22pJ_UGMgwRVpuOYpwK68cIWIDYksink4u7pF3UUZFKTQFrw7uQiGY1RtezaAZC5-2r03BzUidvn1dpnaOgOpbReq-M9IAvrbSgD053NRhZJ8Adb50LP54WxIRvg8edWpl-pw",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 19:49:02.434 +05:30 [DBG] Augmenting SignInContext
2018-04-23 19:49:02.435 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 19:49:02.576 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:49:02.583 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:49:02.584 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:49:02.592 +05:30 [DBG] Start token request.
2018-04-23 19:49:02.600 +05:30 [DBG] Start client validation
2018-04-23 19:49:02.606 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:49:02.611 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:49:02.612 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:49:02.612 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:49:02.617 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:02.628 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:49:02.628 +05:30 [DBG] Client validation success
2018-04-23 19:49:02.634 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94KGDKC21:00000001",
  "TimeStamp": "2018-04-23T14:19:02Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:49:02.641 +05:30 [DBG] Start token request validation
2018-04-23 19:49:02.655 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 19:49:02.668 +05:30 [DBG] Ds4tRpWBt91bbW+KmDrXxyHV2FxnUor1K4UDqVQI98g= found in database: true
2018-04-23 19:49:02.696 +05:30 [DBG] removing Ds4tRpWBt91bbW+KmDrXxyHV2FxnUor1K4UDqVQI98g= persisted grant from database
2018-04-23 19:49:02.706 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 19:49:02.712 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "f1e35e899af3bacb503a32eb655e8f924c4453c836df8f6584b704b4fca5ce30",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "f1e35e899af3bacb503a32eb655e8f924c4453c836df8f6584b704b4fca5ce30",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 19:49:02.731 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:02.739 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:02.810 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.823 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 19:49:02.825 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:49:02.871 +05:30 [DBG] vBZEV9uxBiLxsTFMTCIb27LTdzqyZnrRQxeNmhUXDMA= not found in database
2018-04-23 19:49:02.878 +05:30 [DBG] Creating refresh token
2018-04-23 19:49:02.878 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 19:49:02.891 +05:30 [DBG] wzZHpiFM57W++ShCGVlwUPMaI0GIBhvVLT0aahV1q8g= not found in database
2018-04-23 19:49:02.899 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:02.902 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:02.906 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:49:02.906 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:49:02.907 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:49:02.914 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "Endpoint": "Token",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****iuAQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****f00a"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****e7b3"
    }
  ],
  "ActivityId": "0HLD94KGDKC21:00000001",
  "TimeStamp": "2018-04-23T14:19:02Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:49:02.918 +05:30 [DBG] Token request success.
2018-04-23 19:49:02.938 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 19:49:02.942 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 19:49:02.944 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 19:49:02.952 +05:30 [DBG] Start userinfo request
2018-04-23 19:49:02.956 +05:30 [DBG] Bearer token found in header
2018-04-23 19:49:02.975 +05:30 [DBG] vBZEV9uxBiLxsTFMTCIb27LTdzqyZnrRQxeNmhUXDMA= found in database: true
2018-04-23 19:49:02.996 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:03.006 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:03.009 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:49:03.015 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "7fc2eaf5596daeefbf965cf08875f5a1fc816a5a75a5080f47577f851ecbe7b3",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524493142,
    "exp": 1524493262,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524493136,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:49:03.026 +05:30 [DBG] Creating userinfo response
2018-04-23 19:49:03.031 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:49:03.035 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:49:03.047 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:03.048 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 19:49:03.049 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 19:49:03.051 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:49:03.054 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 19:49:03.054 +05:30 [DBG] End userinfo request
2018-04-23 19:49:04.816 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:49:04.819 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:49:04.820 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:49:04.825 +05:30 [DBG] Start discovery request
2018-04-23 19:49:04.897 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:49:04.943 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:49:04.945 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:49:04.946 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:49:04.950 +05:30 [DBG] Start key discovery request
2018-04-23 19:49:05.147 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:49:05.153 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:49:05.157 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:49:05.179 +05:30 [DBG] Starting introspection request.
2018-04-23 19:49:05.201 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:49:05.207 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:49:05.213 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:49:05.216 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:49:05.315 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:49:05.317 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:49:05.318 +05:30 [DBG] API resource validation success
2018-04-23 19:49:05.331 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94KGDKC23:00000001",
  "TimeStamp": "2018-04-23T14:19:05Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:49:05.339 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:49:05.342 +05:30 [DBG] vBZEV9uxBiLxsTFMTCIb27LTdzqyZnrRQxeNmhUXDMA= found in database: true
2018-04-23 19:49:05.366 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:05.372 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:49:05.374 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:49:05.376 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "7fc2eaf5596daeefbf965cf08875f5a1fc816a5a75a5080f47577f851ecbe7b3",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524493142,
    "exp": 1524493262,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524493136,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:49:05.380 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:49:05.395 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:49:05.409 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****e7b3",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD94KGDKC23:00000001",
  "TimeStamp": "2018-04-23T14:19:05Z",
  "ProcessId": 51468,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:49:05.414 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:51:49.447 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:51:49.480 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:51:49.480 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:51:49.480 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:51:49.481 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 19:51:52.786 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:51:52.793 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:51:52.793 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:51:52.799 +05:30 [DBG] Start discovery request
2018-04-23 19:51:53.995 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:51:54.126 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:51:54.149 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:51:54.150 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:51:54.157 +05:30 [DBG] Start key discovery request
2018-04-23 19:51:54.229 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 19:51:54.240 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 19:51:54.241 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 19:51:54.254 +05:30 [DBG] Start token request.
2018-04-23 19:51:54.261 +05:30 [DBG] Start client validation
2018-04-23 19:51:54.270 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:51:54.271 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:51:54.272 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:51:54.831 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:51:54.846 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:51:54.846 +05:30 [DBG] Client validation success
2018-04-23 19:51:54.888 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94M7L5AJ3:00000001",
  "TimeStamp": "2018-04-23T14:21:54Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:51:54.911 +05:30 [DBG] Start token request validation
2018-04-23 19:51:54.921 +05:30 [DBG] Start validation of refresh token request
2018-04-23 19:51:55.003 +05:30 [DBG] wzZHpiFM57W++ShCGVlwUPMaI0GIBhvVLT0aahV1q8g= found in database: true
2018-04-23 19:51:55.114 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "auth_time": 1524493136,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:51:55.116 +05:30 [DBG] Validation of refresh token request success
2018-04-23 19:51:55.126 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "RefreshToken": "a34249eac90e50cb9cd541ced6bf26f06dc90063c13d6ae2f376208658c9f00a",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "a34249eac90e50cb9cd541ced6bf26f06dc90063c13d6ae2f376208658c9f00a"
  }
}
2018-04-23 19:51:55.204 +05:30 [DBG] qPI8D5zq2TePAqMSI/pcB9fFYrJVPFdeSsKwA8rvqqI= not found in database
2018-04-23 19:51:55.276 +05:30 [DBG] Updating refresh token
2018-04-23 19:51:55.277 +05:30 [DBG] Token usage is one-time only. Generating new handle
2018-04-23 19:51:55.312 +05:30 [DBG] removing wzZHpiFM57W++ShCGVlwUPMaI0GIBhvVLT0aahV1q8g= persisted grant from database
2018-04-23 19:51:55.380 +05:30 [DBG] jocY17OOU1rse3F2SQ84ab3MPSNe0GUvO4R28ik9oJw= not found in database
2018-04-23 19:51:55.409 +05:30 [DBG] Created refresh token in store
2018-04-23 19:51:55.488 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:51:55.719 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:51:55.779 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:51:55.900 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:51:55.912 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 19:51:55.915 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 19:51:55.988 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "Endpoint": "Token",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "Scopes": "openid profile address user-role country subscription imagegallery-api offline_access",
  "GrantType": "refresh_token",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4SIQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****15a7"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****333b"
    }
  ],
  "ActivityId": "0HLD94M7L5AJ3:00000001",
  "TimeStamp": "2018-04-23T14:21:55Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:51:55.995 +05:30 [DBG] Token request success.
2018-04-23 19:51:56.028 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 19:51:56.032 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 19:51:56.033 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 19:51:56.046 +05:30 [DBG] Starting introspection request.
2018-04-23 19:51:56.054 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:51:56.059 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 19:51:56.061 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 19:51:56.062 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 19:51:56.220 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 19:51:56.222 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:51:56.223 +05:30 [DBG] API resource validation success
2018-04-23 19:51:56.229 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94M7L5AJ4:00000001",
  "TimeStamp": "2018-04-23T14:21:56Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:51:56.240 +05:30 [DBG] Introspection request validation started.
2018-04-23 19:51:56.311 +05:30 [DBG] qPI8D5zq2TePAqMSI/pcB9fFYrJVPFdeSsKwA8rvqqI= found in database: true
2018-04-23 19:51:56.549 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:51:56.771 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:51:56.799 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:51:56.801 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "9b841f2552ef5cd6e0c464e1efb2d44de4437aff4b711c2f2b2181feb92b333b",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524493315,
    "exp": 1524493435,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524493136,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 19:51:56.804 +05:30 [DBG] Introspection request validation successful.
2018-04-23 19:51:56.815 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 19:51:56.824 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****333b",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD94M7L5AJ4:00000001",
  "TimeStamp": "2018-04-23T14:21:56Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:51:56.831 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 19:51:59.215 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 19:51:59.217 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 19:51:59.217 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 19:51:59.221 +05:30 [DBG] Start discovery request
2018-04-23 19:51:59.409 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 19:51:59.427 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 19:51:59.429 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 19:51:59.431 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 19:51:59.435 +05:30 [DBG] Start key discovery request
2018-04-23 19:51:59.453 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:51:59.458 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:51:59.460 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:51:59.472 +05:30 [DBG] Start revocation request.
2018-04-23 19:51:59.472 +05:30 [DBG] Start client validation
2018-04-23 19:51:59.473 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:51:59.473 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:51:59.476 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:51:59.740 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:51:59.744 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:51:59.745 +05:30 [DBG] Client validation success
2018-04-23 19:51:59.746 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94M7L5AJ6:00000001",
  "TimeStamp": "2018-04-23T14:21:59Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:51:59.753 +05:30 [DBG] Token type hint found in request: access_token
2018-04-23 19:51:59.753 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:51:59.794 +05:30 [DBG] qPI8D5zq2TePAqMSI/pcB9fFYrJVPFdeSsKwA8rvqqI= found in database: true
2018-04-23 19:51:59.804 +05:30 [DBG] Access token revoked
2018-04-23 19:51:59.826 +05:30 [DBG] removing qPI8D5zq2TePAqMSI/pcB9fFYrJVPFdeSsKwA8rvqqI= persisted grant from database
2018-04-23 19:51:59.854 +05:30 [INF] Token successfully revoked
2018-04-23 19:51:59.867 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "access_token",
  "Token": "****333b",
  "ActivityId": "0HLD94M7L5AJ6:00000001",
  "TimeStamp": "2018-04-23T14:21:59Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:51:59.885 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 19:51:59.887 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 19:51:59.888 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 19:51:59.891 +05:30 [DBG] Start revocation request.
2018-04-23 19:51:59.892 +05:30 [DBG] Start client validation
2018-04-23 19:51:59.893 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 19:51:59.894 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 19:51:59.894 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 19:52:00.193 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:52:00.195 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 19:52:00.195 +05:30 [DBG] Client validation success
2018-04-23 19:52:00.196 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD94M7L5AJ6:00000002",
  "TimeStamp": "2018-04-23T14:22:00Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:52:00.199 +05:30 [DBG] Token type hint found in request: refresh_token
2018-04-23 19:52:00.199 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 19:52:00.239 +05:30 [DBG] jocY17OOU1rse3F2SQ84ab3MPSNe0GUvO4R28ik9oJw= found in database: true
2018-04-23 19:52:00.255 +05:30 [DBG] Refresh token revoked
2018-04-23 19:52:00.278 +05:30 [DBG] removing jocY17OOU1rse3F2SQ84ab3MPSNe0GUvO4R28ik9oJw= persisted grant from database
2018-04-23 19:52:00.343 +05:30 [DBG] removing 1 persisted grants from database for subject d860efca-22d9-47fd-8249-791ba61b07c7, clientId ImageGallery-WebApp, grantType reference_token
2018-04-23 19:52:00.376 +05:30 [INF] Token successfully revoked
2018-04-23 19:52:00.379 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "refresh_token",
  "Token": "****15a7",
  "ActivityId": "0HLD94M7L5AJ6:00000002",
  "TimeStamp": "2018-04-23T14:22:00Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:52:00.410 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:52:00.417 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:52:00.423 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-23 19:52:00.426 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-23 19:52:00.427 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-23 19:52:00.442 +05:30 [DBG] Processing signout request for d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 19:52:00.454 +05:30 [DBG] Start end session request validation
2018-04-23 19:52:00.462 +05:30 [DBG] Start identity token validation
2018-04-23 19:52:00.768 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:52:00.770 +05:30 [DBG] Client found: ImageGallery-WebApp / Image Gallery
2018-04-23 19:52:00.851 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 19:52:00.855 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524493142,
    "exp": 1524493442,
    "iss": "http://localhost:5000",
    "aud": "ImageGallery-WebApp",
    "nonce": "636600898507749354.MGRlZGM3ZWQtZjhhOC00NTIwLTlmY2QtMGNiOWY0YWZhZTU2MjU0ZDQ2NTctOWQ0NS00ZjQ2LWI0YTktOTNkMzJlOTEzM2My",
    "iat": 1524493142,
    "at_hash": "Gw9Fr3RsyNlNme21WfIaaQ",
    "sid": "005770964838210cc48e8c5def1df8a0",
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524493136,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-23 19:52:00.877 +05:30 [INF] End session request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "PostLogOutUri": "http://localhost/imagegallery/signout-callback-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqvfqPc6QHcfoqyzTUi6bUESoqdaQqDfomgmTdPs2gJDUcHrzXfm2JOdVSnrLMmyZlq37wmIIxWAkGoB4jUUwHEjEK3pTmxUtWsnw6UGKopjpQRrKMS447Nx4W_Y_5FIIAk3DodEDDvBhAzDwaCVPRp47-hD8-8FxtpWbUalddxMnw",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost/imagegallery/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImJiZmM3OWE3YWVkNWNlYmU2NDRhM2JhNjM1NmE1YjZlIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ0OTMxNDIsImV4cCI6MTUyNDQ5MzQ0MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiSW1hZ2VHYWxsZXJ5LVdlYkFwcCIsIm5vbmNlIjoiNjM2NjAwODk4NTA3NzQ5MzU0Lk1HUmxaR00zWldRdFpqaGhPQzAwTlRJd0xUbG1ZMlF0TUdOaU9XWTBZV1poWlRVMk1qVTBaRFEyTlRjdE9XUTBOUzAwWmpRMkxXSTBZVGt0T1ROa016SmxPVEV6TTJNeSIsImlhdCI6MTUyNDQ5MzE0MiwiYXRfaGFzaCI6Ikd3OUZyM1JzeU5sTm1lMjFXZklhYVEiLCJzaWQiOiIwMDU3NzA5NjQ4MzgyMTBjYzQ4ZThjNWRlZjFkZjhhMCIsInN1YiI6ImQ4NjBlZmNhLTIyZDktNDdmZC04MjQ5LTc5MWJhNjFiMDdjNyIsImF1dGhfdGltZSI6MTUyNDQ5MzEzNiwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.N2mi6eC7aCQX3R86S2oAWHjwTSegAZcSDu169PyVUj_NpiV3JQFUVFrVI291BVJu5q2U_EkXiCnFlZlOH7Spku8cGqsZz2m_Uor5Ut6R0tvHLJddyPiVxItHskrAAJdNrNmrb4vVyN0L_2E7jNYmbK9ZemgSmmmkQjiR6YiDhe1knSiAtJpo_uaSqOpZdn_k-3k1TW0-ZwxLTsXSLIB1T7ALsdpRoeosMhD5wEUTS6feqoc-Ra0DDRaq5hpJy_0gVg3CkUcXXLDoENGpe4LQ4ODKHc5zoFJVHCS7jDxppLD6iSsxFWP6eEL0sKVtH4eCZjxzQ8N13RHX5GPeJfiuAQ",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqvfqPc6QHcfoqyzTUi6bUESoqdaQqDfomgmTdPs2gJDUcHrzXfm2JOdVSnrLMmyZlq37wmIIxWAkGoB4jUUwHEjEK3pTmxUtWsnw6UGKopjpQRrKMS447Nx4W_Y_5FIIAk3DodEDDvBhAzDwaCVPRp47-hD8-8FxtpWbUalddxMnw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:52:00.887 +05:30 [DBG] Success validating end session request from ImageGallery-WebApp
2018-04-23 19:52:00.935 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:52:00.940 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 19:52:01.293 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-04-23 19:52:01.303 +05:30 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "ActivityId": "0HLD94M7L5AJ7:00000002",
  "TimeStamp": "2018-04-23T14:22:01Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:52:04.331 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-23 19:52:04.357 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-23 19:52:04.360 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-23 19:52:04.376 +05:30 [DBG] Processing signout callback request
2018-04-23 19:52:04.644 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:52:04.646 +05:30 [DBG] No client front-channel logout URLs
2018-04-23 19:52:04.646 +05:30 [DBG] No client back-channel logout URLs
2018-04-23 19:52:04.647 +05:30 [INF] Successful signout callback.
2018-04-23 19:52:04.650 +05:30 [DBG] No client front-channel iframe urls
2018-04-23 19:52:04.650 +05:30 [DBG] No client back-channel iframe urls
2018-04-23 19:52:04.708 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 19:52:04.713 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 19:52:04.714 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 19:52:04.722 +05:30 [DBG] Start authorize request
2018-04-23 19:52:04.731 +05:30 [DBG] No user present in authorize request
2018-04-23 19:52:04.736 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:52:04.972 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:52:04.979 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:52:04.981 +05:30 [DBG] No PKCE used.
2018-04-23 19:52:05.055 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:52:05.246 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:52:05.310 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:52:05.435 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:52:05.447 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:52:05.459 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsShDLCLLR3nrHoU8c9Ez6otemnLhwVGx9q21R9fAOXvlnX1y2pxKHbqMKuk8uf96Eo4qjjW_7JwnXk7qWY7xmuqWYN5NBD9n86W6Sc2dVdC18t6kPcLEGHVvHfZYWcE7R5QOpYRM7HmKtl62MWNo9ivYq-Aapb7Jyk87SkUiI5ZWTbJgi4wc87hyyW6Q3Gl9YQ-GfqQ6wSUeZYdDBj2Vgkl5jc3z3fyumvjemP4XLHqRHLP4tEBvzwcNCJuZUUEbs-DyH3crXxyMZjUR885z7WQo8hqNMCc9AsfbAdgEeVxRBeTCpkEakXCYlyyqgKk9k",
  "Nonce": "636600901247025545.YzUyNGMyMjktZjZkNC00NDA1LTkwNjEtN2Y0Mzk1ZTk0Yzg0YWIxODc0ODMtMWZhMS00N2Y5LTg4YzAtYWZhOTBjYjE2YzFk",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600901247025545.YzUyNGMyMjktZjZkNC00NDA1LTkwNjEtN2Y0Mzk1ZTk0Yzg0YWIxODc0ODMtMWZhMS00N2Y5LTg4YzAtYWZhOTBjYjE2YzFk",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsShDLCLLR3nrHoU8c9Ez6otemnLhwVGx9q21R9fAOXvlnX1y2pxKHbqMKuk8uf96Eo4qjjW_7JwnXk7qWY7xmuqWYN5NBD9n86W6Sc2dVdC18t6kPcLEGHVvHfZYWcE7R5QOpYRM7HmKtl62MWNo9ivYq-Aapb7Jyk87SkUiI5ZWTbJgi4wc87hyyW6Q3Gl9YQ-GfqQ6wSUeZYdDBj2Vgkl5jc3z3fyumvjemP4XLHqRHLP4tEBvzwcNCJuZUUEbs-DyH3crXxyMZjUR885z7WQo8hqNMCc9AsfbAdgEeVxRBeTCpkEakXCYlyyqgKk9k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 19:52:05.477 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 19:52:05.549 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 19:52:05.885 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:52:05.887 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 19:52:05.887 +05:30 [DBG] No PKCE used.
2018-04-23 19:52:05.958 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:52:06.127 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:52:06.201 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 19:52:06.371 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 19:52:06.373 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 19:52:06.675 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 19:52:10.537 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 19:52:10.669 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94M7L5AJ7:00000006",
  "TimeStamp": "2018-04-23T14:22:10Z",
  "ProcessId": 4684,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 19:59:45.264 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 19:59:45.296 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 19:59:45.297 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 19:59:45.297 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 19:59:45.297 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 20:00:06.489 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 20:00:06.496 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 20:00:06.496 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 20:00:06.502 +05:30 [DBG] Start discovery request
2018-04-23 20:00:07.673 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 20:00:08.026 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 20:00:08.060 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 20:00:08.062 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 20:00:08.070 +05:30 [DBG] Start key discovery request
2018-04-23 20:00:08.163 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 20:00:08.172 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 20:00:08.174 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 20:00:08.182 +05:30 [DBG] Start authorize request
2018-04-23 20:00:08.196 +05:30 [DBG] No user present in authorize request
2018-04-23 20:00:08.204 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:00:08.757 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:00:08.767 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:00:08.769 +05:30 [DBG] No PKCE used.
2018-04-23 20:00:08.860 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:00:09.089 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:00:09.151 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:00:09.277 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:00:09.289 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:00:09.304 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqupbOwTGT1oC660WkG6SsG75Uo770E9Vxu1CzGfa-DJxJMBxWkPWfb3Z8ZZSRaAideem-W_eXtfV0h_A8bOdC8SbSQddKZOFL-AsJg6YlrLWdTE4BcgjP25QRRrG8oY1GNIGsrQO3bTNRawNA9VCt2EFxRumgVivGsWbWviQ6vIt1girkI5NQp5vtlslDrgPFufylEbvjIJHVxscw9C5Mn42YxUfucFIixtfOEueCV8c5N-p_VkFG9IpkS0Wwg-7va-KsxuWDKz60nUdBmVeGOQoGxRJjKehIX3TVNZVABCawifA85CyEUOD-R3V-IUnxY",
  "Nonce": "636600906081398297.NWQ5NmM1OTItNmVmZi00OGY4LTg0MzgtOGYwYjFlZmEyNTU3MWEzYzc3NTgtYTIyMS00MzZkLWFkOWQtY2U4OTk3NDY1YTY0",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600906081398297.NWQ5NmM1OTItNmVmZi00OGY4LTg0MzgtOGYwYjFlZmEyNTU3MWEzYzc3NTgtYTIyMS00MzZkLWFkOWQtY2U4OTk3NDY1YTY0",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqupbOwTGT1oC660WkG6SsG75Uo770E9Vxu1CzGfa-DJxJMBxWkPWfb3Z8ZZSRaAideem-W_eXtfV0h_A8bOdC8SbSQddKZOFL-AsJg6YlrLWdTE4BcgjP25QRRrG8oY1GNIGsrQO3bTNRawNA9VCt2EFxRumgVivGsWbWviQ6vIt1girkI5NQp5vtlslDrgPFufylEbvjIJHVxscw9C5Mn42YxUfucFIixtfOEueCV8c5N-p_VkFG9IpkS0Wwg-7va-KsxuWDKz60nUdBmVeGOQoGxRJjKehIX3TVNZVABCawifA85CyEUOD-R3V-IUnxY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:00:09.322 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 20:00:09.615 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:00:09.940 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:00:09.941 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:00:09.942 +05:30 [DBG] No PKCE used.
2018-04-23 20:00:10.005 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:00:10.194 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:00:10.261 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:00:10.433 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:00:10.434 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:00:10.744 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:00:30.385 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:01:03.313 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94QQPIAIG:00000003",
  "TimeStamp": "2018-04-23T14:31:03Z",
  "ProcessId": 16428,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:01:14.114 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94QQPIAIG:00000003",
  "TimeStamp": "2018-04-23T14:31:07Z",
  "ProcessId": 16428,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:01:30.000 +05:30 [DBG] Augmenting SignInContext
2018-04-23 20:01:30.002 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 20:01:30.003 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 20:01:30.019 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 20:01:51.192 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:01:51.197 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:01:51.200 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 20:01:51.202 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 20:01:51.205 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 20:01:51.214 +05:30 [DBG] Start authorize callback request
2018-04-23 20:01:51.218 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:01:51.219 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:01:51.465 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:01:51.467 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:01:51.467 +05:30 [DBG] No PKCE used.
2018-04-23 20:01:51.522 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:01:51.736 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:01:51.816 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:01:52.028 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:01:52.030 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:01:52.031 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqupbOwTGT1oC660WkG6SsG75Uo770E9Vxu1CzGfa-DJxJMBxWkPWfb3Z8ZZSRaAideem-W_eXtfV0h_A8bOdC8SbSQddKZOFL-AsJg6YlrLWdTE4BcgjP25QRRrG8oY1GNIGsrQO3bTNRawNA9VCt2EFxRumgVivGsWbWviQ6vIt1girkI5NQp5vtlslDrgPFufylEbvjIJHVxscw9C5Mn42YxUfucFIixtfOEueCV8c5N-p_VkFG9IpkS0Wwg-7va-KsxuWDKz60nUdBmVeGOQoGxRJjKehIX3TVNZVABCawifA85CyEUOD-R3V-IUnxY",
  "Nonce": "636600906081398297.NWQ5NmM1OTItNmVmZi00OGY4LTg0MzgtOGYwYjFlZmEyNTU3MWEzYzc3NTgtYTIyMS00MzZkLWFkOWQtY2U4OTk3NDY1YTY0",
  "SessionId": "cfd9127c260b47bea2d36947651ea920",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600906081398297.NWQ5NmM1OTItNmVmZi00OGY4LTg0MzgtOGYwYjFlZmEyNTU3MWEzYzc3NTgtYTIyMS00MzZkLWFkOWQtY2U4OTk3NDY1YTY0",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqupbOwTGT1oC660WkG6SsG75Uo770E9Vxu1CzGfa-DJxJMBxWkPWfb3Z8ZZSRaAideem-W_eXtfV0h_A8bOdC8SbSQddKZOFL-AsJg6YlrLWdTE4BcgjP25QRRrG8oY1GNIGsrQO3bTNRawNA9VCt2EFxRumgVivGsWbWviQ6vIt1girkI5NQp5vtlslDrgPFufylEbvjIJHVxscw9C5Mn42YxUfucFIixtfOEueCV8c5N-p_VkFG9IpkS0Wwg-7va-KsxuWDKz60nUdBmVeGOQoGxRJjKehIX3TVNZVABCawifA85CyEUOD-R3V-IUnxY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:01:52.089 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 20:01:52.089 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 20:01:52.108 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:01:52.112 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:02:07.759 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:02:08.105 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:02:08.107 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:02:08.107 +05:30 [DBG] No PKCE used.
2018-04-23 20:02:08.183 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:02:08.412 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:02:08.477 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:02:08.637 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:02:08.639 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:02:08.968 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:02:09.036 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:02:09.281 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:02:21.263 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:02:21.268 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:02:21.271 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:02:26.272 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:02:26.618 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:02:26.619 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:02:26.620 +05:30 [DBG] No PKCE used.
2018-04-23 20:02:26.685 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:02:26.845 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:02:26.913 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:02:27.089 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:02:27.091 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:03:05.262 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:03:05.596 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:03:05.597 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:03:05.597 +05:30 [DBG] No PKCE used.
2018-04-23 20:03:05.669 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:03:05.893 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:03:05.962 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:03:06.123 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:03:06.125 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:05:24.199 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 20:05:24.234 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 20:05:24.234 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 20:05:24.235 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 20:05:24.235 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 20:05:49.602 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 20:05:49.608 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 20:05:49.609 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 20:05:49.616 +05:30 [DBG] Start discovery request
2018-04-23 20:05:50.853 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 20:05:51.223 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 20:05:51.234 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 20:05:51.235 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 20:05:51.242 +05:30 [DBG] Start key discovery request
2018-04-23 20:05:51.341 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:05:51.345 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:05:51.349 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 20:05:51.358 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 20:05:51.359 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 20:05:51.367 +05:30 [DBG] Start authorize request
2018-04-23 20:05:51.381 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:05:51.389 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:05:51.948 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:05:51.959 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:05:51.962 +05:30 [DBG] No PKCE used.
2018-04-23 20:05:52.055 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:05:52.309 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:05:52.378 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:05:52.493 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:05:52.504 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:05:52.518 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqtxc8Z-ALRvFIFVZuhEoDaiwEi1Vw6lxxsnYsWYOnqYls36vMuQOMJ4QZuuTgPWdG1vt_CcC2SaEzNRI6G1Qo_TgVCWqVLPWieEhFp_zHIC8sU3AcnzSBP6Qw-YUF593FQhuMmgB4OXLf2naFML-iy5lkdL7A7AOzeYOsYqJmiZjuWzPS_Ns8SZCDDPGokbP4BNn0r3JzMqfkKNUkeB2YvOZKhV65adqmIROdGEDZGnySxlohTRr-QZxDRWjaqlKAbiy8HiVo9Ag4YACGbQ6NOQbu0mCtaBz0y1ygjFyFgysorCtIa6XOpxi0pjoPXH3io",
  "Nonce": "636600909513103736.ZGNhYjQxNTUtOGYxMC00MDk3LWI1ZWUtZDg1OTUxYmQxNDFhNzIzNjVmMjgtODc5Mi00MmE1LWEyNjQtMzUxNGE2YjExNjY2",
  "SessionId": "cfd9127c260b47bea2d36947651ea920",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600909513103736.ZGNhYjQxNTUtOGYxMC00MDk3LWI1ZWUtZDg1OTUxYmQxNDFhNzIzNjVmMjgtODc5Mi00MmE1LWEyNjQtMzUxNGE2YjExNjY2",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqtxc8Z-ALRvFIFVZuhEoDaiwEi1Vw6lxxsnYsWYOnqYls36vMuQOMJ4QZuuTgPWdG1vt_CcC2SaEzNRI6G1Qo_TgVCWqVLPWieEhFp_zHIC8sU3AcnzSBP6Qw-YUF593FQhuMmgB4OXLf2naFML-iy5lkdL7A7AOzeYOsYqJmiZjuWzPS_Ns8SZCDDPGokbP4BNn0r3JzMqfkKNUkeB2YvOZKhV65adqmIROdGEDZGnySxlohTRr-QZxDRWjaqlKAbiy8HiVo9Ag4YACGbQ6NOQbu0mCtaBz0y1ygjFyFgysorCtIa6XOpxi0pjoPXH3io",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:05:52.607 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 20:05:52.607 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 20:05:52.629 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:05:52.633 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:05:52.966 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:05:53.293 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:05:53.295 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:05:53.295 +05:30 [DBG] No PKCE used.
2018-04-23 20:05:53.360 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:05:53.529 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:05:53.594 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:05:53.762 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:05:53.763 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:05:54.057 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:05:54.123 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:05:54.333 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:06.427 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:06:06.433 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:06:09.104 +05:30 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:06:09.106 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:06:09.109 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:06:09.185 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-04-23 20:06:09.227 +05:30 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "ActivityId": "0HLD94U11P22J:00000004",
  "TimeStamp": "2018-04-23T14:36:09Z",
  "ProcessId": 49572,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:06:24.146 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 20:06:24.150 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 20:06:24.150 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 20:06:24.154 +05:30 [DBG] Start authorize request
2018-04-23 20:06:24.155 +05:30 [DBG] No user present in authorize request
2018-04-23 20:06:24.155 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:06:24.432 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:06:24.434 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:06:24.435 +05:30 [DBG] No PKCE used.
2018-04-23 20:06:24.493 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:24.683 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:24.735 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:24.854 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:24.856 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:06:24.857 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqvYNJqB1i0l36U-A0xYSJT2TEHNlfWd2UIj0Lr8ReQdodhkEvxrn0uescotDT2u9xBFCyMze13s9A4QMo3_6dKOjaRVvCklvlpGNjsqwoGjkH-yMj57bj76zNkS12_5-LZZKAt1t78BaLeA5M_padw9uZOhBSTtYDGKUo4tcIdRl5EXtLD7YH8C4s-xC7p2HEyuLXoQ6RTW7bpQ1Fwydr-KmOYqdVDYGGandVxMy6MVcDxHQIG39biwASAs1XCwq1j6fUWDKfdG3Xaybf05LGLTBAVtW-aF_Zt2qvXasy4JEu-A9LpwYE3iK50wPKo8Ww0",
  "Nonce": "636600909841374118.YmU5ZjI3ZTgtODEwYi00YWJlLWI3NzAtNTk3NDI5NTNiNWFiNmJjMWM0YzItMTVkOC00MzZiLTlmMjQtMTdiMGQwMjM4ODY1",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600909841374118.YmU5ZjI3ZTgtODEwYi00YWJlLWI3NzAtNTk3NDI5NTNiNWFiNmJjMWM0YzItMTVkOC00MzZiLTlmMjQtMTdiMGQwMjM4ODY1",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqvYNJqB1i0l36U-A0xYSJT2TEHNlfWd2UIj0Lr8ReQdodhkEvxrn0uescotDT2u9xBFCyMze13s9A4QMo3_6dKOjaRVvCklvlpGNjsqwoGjkH-yMj57bj76zNkS12_5-LZZKAt1t78BaLeA5M_padw9uZOhBSTtYDGKUo4tcIdRl5EXtLD7YH8C4s-xC7p2HEyuLXoQ6RTW7bpQ1Fwydr-KmOYqdVDYGGandVxMy6MVcDxHQIG39biwASAs1XCwq1j6fUWDKfdG3Xaybf05LGLTBAVtW-aF_Zt2qvXasy4JEu-A9LpwYE3iK50wPKo8Ww0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:06:24.863 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 20:06:24.913 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:06:25.233 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:06:25.235 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:06:25.235 +05:30 [DBG] No PKCE used.
2018-04-23 20:06:25.305 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:25.463 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:25.530 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:25.690 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:25.691 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:06:25.982 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:06:26.309 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:06:26.699 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:06:26.700 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:06:26.701 +05:30 [DBG] No PKCE used.
2018-04-23 20:06:26.764 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:26.927 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:26.992 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:27.169 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:27.171 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:06:27.462 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:06:29.765 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:06:34.118 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD94U11P22K:00000002",
  "TimeStamp": "2018-04-23T14:36:34Z",
  "ProcessId": 49572,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:06:34.699 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:06:35.009 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:06:35.011 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:06:35.011 +05:30 [DBG] No PKCE used.
2018-04-23 20:06:35.074 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:35.234 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:35.301 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:06:35.465 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:06:35.467 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:06:47.731 +05:30 [DBG] Augmenting SignInContext
2018-04-23 20:06:47.734 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 20:06:47.738 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 20:06:47.748 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 20:09:37.622 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 20:09:37.657 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 20:09:37.658 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 20:09:37.658 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 20:09:37.658 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 20:10:09.860 +05:30 [INF] AuthenticationScheme: idsrv was challenged.
2018-04-23 20:10:19.228 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:10:23.378 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD950EHTFEH:00000003",
  "TimeStamp": "2018-04-23T14:40:23Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:10:23.407 +05:30 [DBG] Augmenting SignInContext
2018-04-23 20:10:23.410 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 20:10:23.410 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 20:10:23.425 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 20:10:23.446 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:23.448 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:23.482 +05:30 [ERR] No consent request matching request: null
2018-04-23 20:10:39.178 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:39.183 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:39.186 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 20:10:39.194 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 20:10:39.195 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 20:10:39.205 +05:30 [DBG] Start authorize request
2018-04-23 20:10:39.213 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:10:39.223 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:10:40.370 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:10:40.379 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:10:40.381 +05:30 [DBG] No PKCE used.
2018-04-23 20:10:40.517 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:40.906 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:40.981 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:41.102 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:41.115 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:10:41.159 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqujqCi6ujOINvbRruwzh7ls_8j_q0hpTK5z2jZa1kU1RbGFFDNAa9QV6MNN3j1xJMMuMII4SlS1gMKT8aVcWkbNXYNQYFuOSZpAemQ-m6nhTJd0IN6ZDYmgF8YLKuqyjveeY63HrYwz0O5FDBT0ESy63DuCEa9Td7sdf2LaAsK2K_p2HPzfmxxHaaAIduTLlAbzqluWcY5rKevlNKGZuPUci0raDksse2xxoAEbbCbY_IIBKdOAaXoU8AuAnUnz1eSjeppEUVT2Kazk9c1f5KojpKY7sJdlBqpCid9Iai73B2tnACyPvXIsIl0-BrVghyw",
  "Nonce": "636600912391665347.NmIwMjAyOWUtYzU2OC00N2ZjLWE1MmItZjkzMDUzMGQyOTQ3MDFjMTAxZmEtYjc2Yi00YjE4LTg0OGItMWYyNGIzYWI5ZGQx",
  "SessionId": "10e37facba7f76f06497ba0fe3fea817",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600912391665347.NmIwMjAyOWUtYzU2OC00N2ZjLWE1MmItZjkzMDUzMGQyOTQ3MDFjMTAxZmEtYjc2Yi00YjE4LTg0OGItMWYyNGIzYWI5ZGQx",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqujqCi6ujOINvbRruwzh7ls_8j_q0hpTK5z2jZa1kU1RbGFFDNAa9QV6MNN3j1xJMMuMII4SlS1gMKT8aVcWkbNXYNQYFuOSZpAemQ-m6nhTJd0IN6ZDYmgF8YLKuqyjveeY63HrYwz0O5FDBT0ESy63DuCEa9Td7sdf2LaAsK2K_p2HPzfmxxHaaAIduTLlAbzqluWcY5rKevlNKGZuPUci0raDksse2xxoAEbbCbY_IIBKdOAaXoU8AuAnUnz1eSjeppEUVT2Kazk9c1f5KojpKY7sJdlBqpCid9Iai73B2tnACyPvXIsIl0-BrVghyw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:10:41.223 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 20:10:41.224 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 20:10:41.245 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:41.250 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:41.284 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:10:41.645 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:10:41.647 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:10:41.647 +05:30 [DBG] No PKCE used.
2018-04-23 20:10:41.713 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:41.881 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:41.948 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:42.123 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:42.125 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:10:42.431 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:10:42.495 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:42.717 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:43.115 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:43.120 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:43.161 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:10:43.551 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:10:43.553 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:10:43.553 +05:30 [DBG] No PKCE used.
2018-04-23 20:10:43.616 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:43.779 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:43.844 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:44.014 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:44.016 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:10:44.307 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:10:44.370 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:44.521 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:45.890 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:10:45.892 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:45.895 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:10:51.830 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:10:52.152 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:10:52.153 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:10:52.154 +05:30 [DBG] No PKCE used.
2018-04-23 20:10:52.217 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:52.377 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:52.442 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:10:52.608 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:10:52.610 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:12:48.554 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:12:48.957 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:12:48.959 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:12:48.959 +05:30 [DBG] No PKCE used.
2018-04-23 20:12:49.038 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:12:49.293 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:12:49.382 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:12:49.684 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:12:49.686 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:13:17.277 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:13:17.338 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:13:17.339 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:13:17.340 +05:30 [DBG] No PKCE used.
2018-04-23 20:13:17.354 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:13:17.445 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:13:17.455 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:13:17.477 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:13:17.478 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:13:19.386 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:13:19.424 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:13:19.425 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:13:19.426 +05:30 [DBG] No PKCE used.
2018-04-23 20:13:19.435 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:13:19.456 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:13:19.466 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:13:19.492 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:13:19.493 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:25:03.543 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:25:03.547 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:25:03.550 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 20:25:03.552 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 20:25:03.552 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 20:25:03.569 +05:30 [DBG] Start authorize callback request
2018-04-23 20:25:03.625 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:25:03.626 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:25:03.889 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:03.891 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:25:03.891 +05:30 [DBG] No PKCE used.
2018-04-23 20:25:03.939 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:25:04.121 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:25:04.170 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:25:04.315 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:25:04.317 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:25:04.317 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqujqCi6ujOINvbRruwzh7ls_8j_q0hpTK5z2jZa1kU1RbGFFDNAa9QV6MNN3j1xJMMuMII4SlS1gMKT8aVcWkbNXYNQYFuOSZpAemQ-m6nhTJd0IN6ZDYmgF8YLKuqyjveeY63HrYwz0O5FDBT0ESy63DuCEa9Td7sdf2LaAsK2K_p2HPzfmxxHaaAIduTLlAbzqluWcY5rKevlNKGZuPUci0raDksse2xxoAEbbCbY_IIBKdOAaXoU8AuAnUnz1eSjeppEUVT2Kazk9c1f5KojpKY7sJdlBqpCid9Iai73B2tnACyPvXIsIl0-BrVghyw",
  "Nonce": "636600912391665347.NmIwMjAyOWUtYzU2OC00N2ZjLWE1MmItZjkzMDUzMGQyOTQ3MDFjMTAxZmEtYjc2Yi00YjE4LTg0OGItMWYyNGIzYWI5ZGQx",
  "SessionId": "10e37facba7f76f06497ba0fe3fea817",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600912391665347.NmIwMjAyOWUtYzU2OC00N2ZjLWE1MmItZjkzMDUzMGQyOTQ3MDFjMTAxZmEtYjc2Yi00YjE4LTg0OGItMWYyNGIzYWI5ZGQx",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqujqCi6ujOINvbRruwzh7ls_8j_q0hpTK5z2jZa1kU1RbGFFDNAa9QV6MNN3j1xJMMuMII4SlS1gMKT8aVcWkbNXYNQYFuOSZpAemQ-m6nhTJd0IN6ZDYmgF8YLKuqyjveeY63HrYwz0O5FDBT0ESy63DuCEa9Td7sdf2LaAsK2K_p2HPzfmxxHaaAIduTLlAbzqluWcY5rKevlNKGZuPUci0raDksse2xxoAEbbCbY_IIBKdOAaXoU8AuAnUnz1eSjeppEUVT2Kazk9c1f5KojpKY7sJdlBqpCid9Iai73B2tnACyPvXIsIl0-BrVghyw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:25:04.352 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 20:25:04.359 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 20:25:04.367 +05:30 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:25:04.430 +05:30 [DBG] no jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= persisted grant found in database
2018-04-23 20:25:04.439 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 20:25:04.515 +05:30 [DBG] YSziOcCkvCThukE227Q3PauMp0iTiAZqNHag3J9EOfE= not found in database
2018-04-23 20:25:04.607 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 20:25:04.619 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 20:25:04.622 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 20:25:04.711 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****r-mw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****2a74"
    }
  ],
  "ActivityId": "0HLD950EHTFEH:00000008",
  "TimeStamp": "2018-04-23T14:55:04Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:04.721 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqujqCi6ujOINvbRruwzh7ls_8j_q0hpTK5z2jZa1kU1RbGFFDNAa9QV6MNN3j1xJMMuMII4SlS1gMKT8aVcWkbNXYNQYFuOSZpAemQ-m6nhTJd0IN6ZDYmgF8YLKuqyjveeY63HrYwz0O5FDBT0ESy63DuCEa9Td7sdf2LaAsK2K_p2HPzfmxxHaaAIduTLlAbzqluWcY5rKevlNKGZuPUci0raDksse2xxoAEbbCbY_IIBKdOAaXoU8AuAnUnz1eSjeppEUVT2Kazk9c1f5KojpKY7sJdlBqpCid9Iai73B2tnACyPvXIsIl0-BrVghyw",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 20:25:04.746 +05:30 [DBG] Augmenting SignInContext
2018-04-23 20:25:04.747 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 20:25:04.936 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 20:25:04.946 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 20:25:04.947 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 20:25:04.963 +05:30 [DBG] Start token request.
2018-04-23 20:25:04.971 +05:30 [DBG] Start client validation
2018-04-23 20:25:04.978 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 20:25:04.984 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 20:25:04.986 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 20:25:04.986 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 20:25:05.230 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:05.241 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 20:25:05.241 +05:30 [DBG] Client validation success
2018-04-23 20:25:05.247 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD950EHTFEJ:00000001",
  "TimeStamp": "2018-04-23T14:55:05Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:05.256 +05:30 [DBG] Start token request validation
2018-04-23 20:25:05.270 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 20:25:05.312 +05:30 [DBG] YSziOcCkvCThukE227Q3PauMp0iTiAZqNHag3J9EOfE= found in database: true
2018-04-23 20:25:05.362 +05:30 [DBG] removing YSziOcCkvCThukE227Q3PauMp0iTiAZqNHag3J9EOfE= persisted grant from database
2018-04-23 20:25:05.420 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 20:25:05.427 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "698482441fc45a3e3fe7db2a3727ab48e74f491638cba656e1f3d7b6a0ec2a74",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "698482441fc45a3e3fe7db2a3727ab48e74f491638cba656e1f3d7b6a0ec2a74",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 20:25:05.693 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:05.752 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:25:05.960 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:25:05.978 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 20:25:05.980 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:25:06.129 +05:30 [DBG] aE16BODesR52JxuKGgubBK5JMtf3VcQv/tsEkYEGzT8= not found in database
2018-04-23 20:25:06.161 +05:30 [DBG] Creating refresh token
2018-04-23 20:25:06.161 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 20:25:06.203 +05:30 [DBG] vBM9CYUVCFMcWEqjttG4EK4hVflYHLcNHRdeHSUiVUk= not found in database
2018-04-23 20:25:06.469 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:06.516 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:25:06.644 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:25:06.646 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 20:25:06.647 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 20:25:06.652 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "Endpoint": "Token",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****8MlQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****406b"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****8649"
    }
  ],
  "ActivityId": "0HLD950EHTFEJ:00000001",
  "TimeStamp": "2018-04-23T14:55:06Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:06.662 +05:30 [DBG] Token request success.
2018-04-23 20:25:06.688 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 20:25:06.692 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 20:25:06.692 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 20:25:06.702 +05:30 [DBG] Start userinfo request
2018-04-23 20:25:06.706 +05:30 [DBG] Bearer token found in header
2018-04-23 20:25:06.755 +05:30 [DBG] aE16BODesR52JxuKGgubBK5JMtf3VcQv/tsEkYEGzT8= found in database: true
2018-04-23 20:25:07.012 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:07.247 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:07.275 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 20:25:07.284 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "c99028bedd8ccce97b8a47e8c915d128037d27a8a6743cc7123d011ac6b38649",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524495306,
    "exp": 1524495426,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524494423,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 20:25:07.317 +05:30 [DBG] Creating userinfo response
2018-04-23 20:25:07.321 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 20:25:07.325 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 20:25:07.385 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:25:07.388 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 20:25:07.389 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 20:25:07.437 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:25:07.489 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 20:25:07.493 +05:30 [DBG] End userinfo request
2018-04-23 20:25:09.538 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 20:25:09.542 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 20:25:09.543 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 20:25:09.550 +05:30 [DBG] Start discovery request
2018-04-23 20:25:09.843 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 20:25:09.917 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 20:25:09.919 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 20:25:09.920 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 20:25:09.927 +05:30 [DBG] Start key discovery request
2018-04-23 20:25:10.187 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 20:25:10.191 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 20:25:10.192 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 20:25:10.214 +05:30 [DBG] Starting introspection request.
2018-04-23 20:25:10.220 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 20:25:10.221 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 20:25:10.221 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 20:25:10.222 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 20:25:10.383 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 20:25:10.385 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 20:25:10.385 +05:30 [DBG] API resource validation success
2018-04-23 20:25:10.392 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD950EHTFEL:00000001",
  "TimeStamp": "2018-04-23T14:55:10Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:10.402 +05:30 [DBG] Introspection request validation started.
2018-04-23 20:25:10.431 +05:30 [DBG] aE16BODesR52JxuKGgubBK5JMtf3VcQv/tsEkYEGzT8= found in database: true
2018-04-23 20:25:10.680 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:10.913 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:10.939 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 20:25:10.941 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "c99028bedd8ccce97b8a47e8c915d128037d27a8a6743cc7123d011ac6b38649",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524495306,
    "exp": 1524495426,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524494423,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 20:25:10.943 +05:30 [DBG] Introspection request validation successful.
2018-04-23 20:25:10.953 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 20:25:10.963 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****8649",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD950EHTFEL:00000001",
  "TimeStamp": "2018-04-23T14:55:10Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:10.968 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 20:25:34.090 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 20:25:34.105 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 20:25:34.106 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 20:25:34.109 +05:30 [DBG] Starting introspection request.
2018-04-23 20:25:34.109 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 20:25:34.111 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 20:25:34.112 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 20:25:34.113 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 20:25:34.230 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 20:25:34.232 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 20:25:34.233 +05:30 [DBG] API resource validation success
2018-04-23 20:25:34.233 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD950EHTFEL:00000002",
  "TimeStamp": "2018-04-23T14:55:34Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:34.237 +05:30 [DBG] Introspection request validation started.
2018-04-23 20:25:34.262 +05:30 [DBG] aE16BODesR52JxuKGgubBK5JMtf3VcQv/tsEkYEGzT8= found in database: true
2018-04-23 20:25:34.503 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:34.729 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:25:34.755 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 20:25:34.757 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "c99028bedd8ccce97b8a47e8c915d128037d27a8a6743cc7123d011ac6b38649",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524495306,
    "exp": 1524495426,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524494423,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 20:25:34.759 +05:30 [DBG] Introspection request validation successful.
2018-04-23 20:25:34.760 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 20:25:34.760 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****8649",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD950EHTFEL:00000002",
  "TimeStamp": "2018-04-23T14:55:34Z",
  "ProcessId": 30940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:25:34.764 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 20:42:31.144 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 20:42:31.177 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 20:42:31.178 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 20:42:31.178 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 20:42:31.178 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 20:42:36.265 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 20:42:36.271 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 20:42:36.271 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 20:42:36.279 +05:30 [DBG] Start discovery request
2018-04-23 20:42:37.491 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 20:42:37.646 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 20:42:37.683 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 20:42:37.693 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 20:42:37.700 +05:30 [DBG] Start key discovery request
2018-04-23 20:42:37.962 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 20:42:37.969 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 20:42:37.970 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 20:42:37.981 +05:30 [DBG] Start revocation request.
2018-04-23 20:42:37.989 +05:30 [DBG] Start client validation
2018-04-23 20:42:37.995 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 20:42:37.996 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 20:42:37.997 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 20:42:38.558 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:42:38.572 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 20:42:38.572 +05:30 [DBG] Client validation success
2018-04-23 20:42:38.612 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD95IIM4L5U:00000001",
  "TimeStamp": "2018-04-23T15:12:38Z",
  "ProcessId": 52832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:42:38.632 +05:30 [DBG] Token type hint found in request: access_token
2018-04-23 20:42:38.632 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 20:42:38.722 +05:30 [DBG] aE16BODesR52JxuKGgubBK5JMtf3VcQv/tsEkYEGzT8= found in database: true
2018-04-23 20:42:38.764 +05:30 [DBG] Access token revoked
2018-04-23 20:42:38.798 +05:30 [DBG] removing aE16BODesR52JxuKGgubBK5JMtf3VcQv/tsEkYEGzT8= persisted grant from database
2018-04-23 20:42:38.857 +05:30 [INF] Token successfully revoked
2018-04-23 20:42:38.866 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "access_token",
  "Token": "****8649",
  "ActivityId": "0HLD95IIM4L5U:00000001",
  "TimeStamp": "2018-04-23T15:12:38Z",
  "ProcessId": 52832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:42:38.888 +05:30 [DBG] Request path /connect/revocation matched to endpoint type Revocation
2018-04-23 20:42:38.891 +05:30 [DBG] Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
2018-04-23 20:42:38.892 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
2018-04-23 20:42:38.895 +05:30 [DBG] Start revocation request.
2018-04-23 20:42:38.896 +05:30 [DBG] Start client validation
2018-04-23 20:42:38.896 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 20:42:38.897 +05:30 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-23 20:42:38.897 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 20:42:39.121 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:42:39.124 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 20:42:39.124 +05:30 [DBG] Client validation success
2018-04-23 20:42:39.125 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD95IIM4L5U:00000002",
  "TimeStamp": "2018-04-23T15:12:39Z",
  "ProcessId": 52832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:42:39.128 +05:30 [DBG] Token type hint found in request: refresh_token
2018-04-23 20:42:39.128 +05:30 [DBG] ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
2018-04-23 20:42:39.159 +05:30 [DBG] vBM9CYUVCFMcWEqjttG4EK4hVflYHLcNHRdeHSUiVUk= found in database: true
2018-04-23 20:42:39.173 +05:30 [DBG] Refresh token revoked
2018-04-23 20:42:39.196 +05:30 [DBG] removing vBM9CYUVCFMcWEqjttG4EK4hVflYHLcNHRdeHSUiVUk= persisted grant from database
2018-04-23 20:42:39.260 +05:30 [DBG] removing 0 persisted grants from database for subject d860efca-22d9-47fd-8249-791ba61b07c7, clientId ImageGallery-WebApp, grantType reference_token
2018-04-23 20:42:39.263 +05:30 [INF] Token successfully revoked
2018-04-23 20:42:39.265 +05:30 [INF] {
  "Name": "Token Revoked Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2010,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "TokenType": "refresh_token",
  "Token": "****406b",
  "ActivityId": "0HLD95IIM4L5U:00000002",
  "TimeStamp": "2018-04-23T15:12:39Z",
  "ProcessId": 52832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:42:39.293 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 20:42:39.294 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 20:42:39.295 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 20:42:39.297 +05:30 [DBG] Start discovery request
2018-04-23 20:42:39.454 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 20:42:39.511 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 20:42:39.513 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 20:42:39.513 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 20:42:39.519 +05:30 [DBG] Start key discovery request
2018-04-23 20:42:39.592 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:42:39.597 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:42:39.601 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-23 20:42:39.607 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-23 20:42:39.608 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-23 20:42:39.623 +05:30 [DBG] Processing signout request for d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 20:42:39.634 +05:30 [DBG] Start end session request validation
2018-04-23 20:42:39.645 +05:30 [DBG] Start identity token validation
2018-04-23 20:42:39.929 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:42:39.930 +05:30 [DBG] Client found: ImageGallery-WebApp / Image Gallery
2018-04-23 20:42:40.065 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 20:42:40.075 +05:30 [DBG] Token validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524495306,
    "exp": 1524495606,
    "iss": "http://localhost:5000",
    "aud": "ImageGallery-WebApp",
    "nonce": "636600912391665347.NmIwMjAyOWUtYzU2OC00N2ZjLWE1MmItZjkzMDUzMGQyOTQ3MDFjMTAxZmEtYjc2Yi00YjE4LTg0OGItMWYyNGIzYWI5ZGQx",
    "iat": 1524495306,
    "at_hash": "ta2RQ-KAjNDyfTAhWKfvDA",
    "sid": "10e37facba7f76f06497ba0fe3fea817",
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524494423,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-23 20:42:40.093 +05:30 [INF] End session request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "PostLogOutUri": "http://localhost/imagegallery/signout-callback-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt80t0iFLki2BJqqWwtH-oiIn7EuPmUKm6vqkfQ4s57W-UpbrZG6rVtmohyd1h6OKtbpcDN-aevjgacVj35VpvW7v5iuPl6XVCS4rURTC5Z_jR8kitXSCTuXg5p1U8jfBZ4B6vaBMWV_PxsWr3xAUnzCXFoKurCZA7ErgEEGk3d6A",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost/imagegallery/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImJiZmM3OWE3YWVkNWNlYmU2NDRhM2JhNjM1NmE1YjZlIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ0OTUzMDYsImV4cCI6MTUyNDQ5NTYwNiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiSW1hZ2VHYWxsZXJ5LVdlYkFwcCIsIm5vbmNlIjoiNjM2NjAwOTEyMzkxNjY1MzQ3Lk5tSXdNakF5T1dVdFl6VTJPQzAwTjJaakxXRTFNbUl0Wmprek1EVXpNR1F5T1RRM01ERmpNVEF4Wm1FdFlqYzJZaTAwWWpFNExUZzBPR0l0TVdZeU5HSXpZV0k1WkdReCIsImlhdCI6MTUyNDQ5NTMwNiwiYXRfaGFzaCI6InRhMlJRLUtBak5EeWZUQWhXS2Z2REEiLCJzaWQiOiIxMGUzN2ZhY2JhN2Y3NmYwNjQ5N2JhMGZlM2ZlYTgxNyIsInN1YiI6ImQ4NjBlZmNhLTIyZDktNDdmZC04MjQ5LTc5MWJhNjFiMDdjNyIsImF1dGhfdGltZSI6MTUyNDQ5NDQyMywiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.rXAEGAq1D4A6p16Z7wCGbFJmaVGx9voYt6jp9UNJvhPTM4MIXX4rNMZsIXTA_-iQyNK7oXPrXVL7FdrEoeYgdpBL6d6CUNyzM_wstxVWD1oUU1CKcQ6IJPXr-tulv39QeWBlg88BgeNKKwUfhylr3u_VAZ-BM8GQs3mTrH3DhLLCMei5VL_xihFqxySHR2AjQYl2VRMuwMWn-Pr0DfHa0_C6HvIsjcl_tDYdJE1qQ5K1SqUb7LaDe_BiFjojZ55DivK3AxtmfRE1f3Arjikwkqe1ZU8-byTcaNtlSevTpOkBnENYDDzi-0ytfHyukZBSIr7m9pznM9lKJpuf_F8MlQ",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5Tyqt80t0iFLki2BJqqWwtH-oiIn7EuPmUKm6vqkfQ4s57W-UpbrZG6rVtmohyd1h6OKtbpcDN-aevjgacVj35VpvW7v5iuPl6XVCS4rURTC5Z_jR8kitXSCTuXg5p1U8jfBZ4B6vaBMWV_PxsWr3xAUnzCXFoKurCZA7ErgEEGk3d6A",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:42:40.102 +05:30 [DBG] Success validating end session request from ImageGallery-WebApp
2018-04-23 20:42:40.147 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:42:40.151 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 20:42:40.476 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-04-23 20:42:40.486 +05:30 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "ActivityId": "0HLD95IIM4L60:00000002",
  "TimeStamp": "2018-04-23T15:12:40Z",
  "ProcessId": 52832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:42:43.916 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-23 20:42:43.945 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-23 20:42:43.948 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-23 20:42:43.968 +05:30 [DBG] Processing signout callback request
2018-04-23 20:42:44.269 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:42:44.271 +05:30 [DBG] No client front-channel logout URLs
2018-04-23 20:42:44.272 +05:30 [DBG] No client back-channel logout URLs
2018-04-23 20:42:44.272 +05:30 [INF] Successful signout callback.
2018-04-23 20:42:44.276 +05:30 [DBG] No client front-channel iframe urls
2018-04-23 20:42:44.277 +05:30 [DBG] No client back-channel iframe urls
2018-04-23 20:42:44.367 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 20:42:44.373 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 20:42:44.374 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 20:42:44.383 +05:30 [DBG] Start authorize request
2018-04-23 20:42:44.393 +05:30 [DBG] No user present in authorize request
2018-04-23 20:42:44.398 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:42:44.662 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:42:44.671 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:42:44.673 +05:30 [DBG] No PKCE used.
2018-04-23 20:42:44.785 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:42:45.044 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:42:45.110 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:42:45.227 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:42:45.239 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:42:45.256 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsKI2gBilHYa-fz-owvM1k7CXdPy4_XgkAETYix1LaBRyC5BAhX23gPT19YBBVSoivE77UWCpULXmp4zY0-bZ3Numx1rYPuuM_oN6OJS-VMGykj5HFY6KHDghTguHAPv7c9BmBRtzbasV0yY3fMLWsZtiEfMbd8hF1ATkb3RbOaEMjPw2aN_bU3ajWaElAwZ0JJTrr9JFBFGxx8dlLAGoHJwH15hj8cV0w33Q34I4ULseaJTTwSR6TM4T9mQINGcdoL_pzWe7_Ds48FP48xI_9KvFNqHEFrr08wu1fgsDDBW9QmMT1EnU4DGNTlRj4q9-o",
  "Nonce": "636600931643572865.ZDk0MDFkNTUtNTk1Mi00ZmIxLWJhZDUtMDhiNTBlZjU1ZWI4ZjgwNmU4ZDItMzUyOS00YmU0LTllOTUtY2E5OTUzMjIwNjE1",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600931643572865.ZDk0MDFkNTUtNTk1Mi00ZmIxLWJhZDUtMDhiNTBlZjU1ZWI4ZjgwNmU4ZDItMzUyOS00YmU0LTllOTUtY2E5OTUzMjIwNjE1",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsKI2gBilHYa-fz-owvM1k7CXdPy4_XgkAETYix1LaBRyC5BAhX23gPT19YBBVSoivE77UWCpULXmp4zY0-bZ3Numx1rYPuuM_oN6OJS-VMGykj5HFY6KHDghTguHAPv7c9BmBRtzbasV0yY3fMLWsZtiEfMbd8hF1ATkb3RbOaEMjPw2aN_bU3ajWaElAwZ0JJTrr9JFBFGxx8dlLAGoHJwH15hj8cV0w33Q34I4ULseaJTTwSR6TM4T9mQINGcdoL_pzWe7_Ds48FP48xI_9KvFNqHEFrr08wu1fgsDDBW9QmMT1EnU4DGNTlRj4q9-o",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:42:45.275 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 20:42:45.342 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:42:45.689 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:42:45.691 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:42:45.692 +05:30 [DBG] No PKCE used.
2018-04-23 20:42:45.767 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:42:45.941 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:42:46.012 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:42:46.209 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:42:46.212 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:42:46.560 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:44:58.545 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:45:04.881 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD95IIM4L60:00000006",
  "TimeStamp": "2018-04-23T15:15:04Z",
  "ProcessId": 52832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:49:35.889 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 20:49:35.923 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 20:49:35.923 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 20:49:35.924 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 20:49:35.924 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 20:49:46.341 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 20:49:46.348 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 20:49:46.348 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 20:49:46.354 +05:30 [DBG] Start discovery request
2018-04-23 20:49:47.537 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 20:49:47.875 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 20:49:47.878 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 20:49:47.879 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 20:49:47.907 +05:30 [DBG] Start key discovery request
2018-04-23 20:49:48.005 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 20:49:48.015 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 20:49:48.016 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 20:49:48.022 +05:30 [DBG] Start authorize request
2018-04-23 20:49:48.035 +05:30 [DBG] No user present in authorize request
2018-04-23 20:49:48.041 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:49:48.647 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:49:48.656 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:49:48.658 +05:30 [DBG] No PKCE used.
2018-04-23 20:49:48.752 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:49:49.000 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:49:49.061 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:49:49.187 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:49:49.199 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:49:49.215 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyquZgeySVfAsF0apBtp6UCyU6h9QyrXDAF1HAxb9oPwG2BI4V4VgUi-aFmrgG_UVnBjtNPVuWsGCiEptlvbvVPTXjRpgOdeeLTbfFd8LM_vEFqr2RrbGKYvD367Bl4GZgcSp-Fu6H_FFeJEW17K3v83P3AhSp8xk9mnbo7XzJxXefT3FHsH8trtH3nxxKtBfhJ1PfPrdhGYEArxDBjoZph55pJL9Nqihu4pvDkJ29RfnBhGBrc_VgbHu3XTmzdtS0uijtb5TkIaYddi_Jz9sSV7R1b6YjKilkcUvT02nw8zHK-yHHojew5LNdNldNHlkGV8",
  "Nonce": "636600935879786550.YzVhMGZjMzktMWI1Yy00Y2Y3LWEwNGMtYWI0YjE2NzAxY2I4ZmQ1MTk3OTYtM2VjNy00Mjc3LWFjMjMtYjhmYzE4MmVmNGMy",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600935879786550.YzVhMGZjMzktMWI1Yy00Y2Y3LWEwNGMtYWI0YjE2NzAxY2I4ZmQ1MTk3OTYtM2VjNy00Mjc3LWFjMjMtYjhmYzE4MmVmNGMy",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyquZgeySVfAsF0apBtp6UCyU6h9QyrXDAF1HAxb9oPwG2BI4V4VgUi-aFmrgG_UVnBjtNPVuWsGCiEptlvbvVPTXjRpgOdeeLTbfFd8LM_vEFqr2RrbGKYvD367Bl4GZgcSp-Fu6H_FFeJEW17K3v83P3AhSp8xk9mnbo7XzJxXefT3FHsH8trtH3nxxKtBfhJ1PfPrdhGYEArxDBjoZph55pJL9Nqihu4pvDkJ29RfnBhGBrc_VgbHu3XTmzdtS0uijtb5TkIaYddi_Jz9sSV7R1b6YjKilkcUvT02nw8zHK-yHHojew5LNdNldNHlkGV8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 20:49:49.230 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 20:49:49.522 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:49:49.892 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:49:49.894 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:49:49.894 +05:30 [DBG] No PKCE used.
2018-04-23 20:49:49.962 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:49:50.146 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:49:50.218 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:49:50.386 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:49:50.388 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:49:50.714 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:49:57.628 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 20:49:59.801 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 20:50:00.124 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 20:50:00.126 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 20:50:00.127 +05:30 [DBG] No PKCE used.
2018-04-23 20:50:00.191 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:50:00.349 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:50:00.414 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 20:50:00.587 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 20:50:00.589 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 20:50:02.549 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD95MIRLT2T:00000003",
  "TimeStamp": "2018-04-23T15:20:02Z",
  "ProcessId": 51644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 20:50:18.369 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD95MIRLT2T:00000003",
  "TimeStamp": "2018-04-23T15:20:08Z",
  "ProcessId": 51644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:02:20.631 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 21:02:20.671 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 21:02:20.671 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 21:02:20.672 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 21:02:20.672 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 21:03:30.547 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 21:03:30.553 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 21:03:30.554 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 21:03:30.560 +05:30 [DBG] Start discovery request
2018-04-23 21:03:31.781 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 21:03:32.149 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 21:03:32.176 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 21:03:32.178 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 21:03:32.187 +05:30 [DBG] Start key discovery request
2018-04-23 21:03:32.288 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 21:03:32.300 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 21:03:32.301 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 21:03:32.308 +05:30 [DBG] Start authorize request
2018-04-23 21:03:32.326 +05:30 [DBG] No user present in authorize request
2018-04-23 21:03:32.335 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:03:32.966 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:03:32.979 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:03:32.981 +05:30 [DBG] No PKCE used.
2018-04-23 21:03:33.084 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:33.121 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 21:03:33.124 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 21:03:33.125 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 21:03:33.128 +05:30 [DBG] Start authorize request
2018-04-23 21:03:33.129 +05:30 [DBG] No user present in authorize request
2018-04-23 21:03:33.130 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:03:33.479 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:03:33.481 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:03:33.482 +05:30 [DBG] No PKCE used.
2018-04-23 21:03:33.573 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:33.643 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:33.718 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:33.809 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:33.809 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:34.068 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:34.094 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:34.104 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:03:34.104 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:03:34.123 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsZ94UH-vTBgTzaR_KLD5IiXcshIT2pOzPAUdbIPoBI1FP0oQ59c2eEnPEmvN3RlpBlC95C0hZnZuI5YHYs-wOtNF05uj7EwZgn1_mv2LJIVI_xjGWczBG_Z5JLyoeWfIRkz9y1lYceRO3Gr58qG2ygpumkCqMwGscIeO7aX_4AwcepY_-DNWq4r7J98pn6uOFUguAJ2LY--mauLntt1v9hNr2z2JrLrWuzKJD8ZauhPJO5s6qd5JIQGloygqTEA5g_O33E2hdiD4bHO6SLUs3ckz3P32xbstw5xJMSJyeo0GB82MrtL2_f6qNwAq1YwxQ",
  "Nonce": "636600944122610573.MmEzZGNkMTYtOTgyNS00MzY0LTg2ZmEtMzdhZjJlMjIyNjJkYzAzN2MwYzMtMzM2OS00MjlkLTg3MDEtOGY5OTNiNWFkNjIy",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600944122610573.MmEzZGNkMTYtOTgyNS00MzY0LTg2ZmEtMzdhZjJlMjIyNjJkYzAzN2MwYzMtMzM2OS00MjlkLTg3MDEtOGY5OTNiNWFkNjIy",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsZ94UH-vTBgTzaR_KLD5IiXcshIT2pOzPAUdbIPoBI1FP0oQ59c2eEnPEmvN3RlpBlC95C0hZnZuI5YHYs-wOtNF05uj7EwZgn1_mv2LJIVI_xjGWczBG_Z5JLyoeWfIRkz9y1lYceRO3Gr58qG2ygpumkCqMwGscIeO7aX_4AwcepY_-DNWq4r7J98pn6uOFUguAJ2LY--mauLntt1v9hNr2z2JrLrWuzKJD8ZauhPJO5s6qd5JIQGloygqTEA5g_O33E2hdiD4bHO6SLUs3ckz3P32xbstw5xJMSJyeo0GB82MrtL2_f6qNwAq1YwxQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 21:03:34.123 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsZ94UH-vTBgTzaR_KLD5IiXcshIT2pOzPAUdbIPoBI1FP0oQ59c2eEnPEmvN3RlpBlC95C0hZnZuI5YHYs-wOtNF05uj7EwZgn1_mv2LJIVI_xjGWczBG_Z5JLyoeWfIRkz9y1lYceRO3Gr58qG2ygpumkCqMwGscIeO7aX_4AwcepY_-DNWq4r7J98pn6uOFUguAJ2LY--mauLntt1v9hNr2z2JrLrWuzKJD8ZauhPJO5s6qd5JIQGloygqTEA5g_O33E2hdiD4bHO6SLUs3ckz3P32xbstw5xJMSJyeo0GB82MrtL2_f6qNwAq1YwxQ",
  "Nonce": "636600944122610573.MmEzZGNkMTYtOTgyNS00MzY0LTg2ZmEtMzdhZjJlMjIyNjJkYzAzN2MwYzMtMzM2OS00MjlkLTg3MDEtOGY5OTNiNWFkNjIy",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600944122610573.MmEzZGNkMTYtOTgyNS00MzY0LTg2ZmEtMzdhZjJlMjIyNjJkYzAzN2MwYzMtMzM2OS00MjlkLTg3MDEtOGY5OTNiNWFkNjIy",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsZ94UH-vTBgTzaR_KLD5IiXcshIT2pOzPAUdbIPoBI1FP0oQ59c2eEnPEmvN3RlpBlC95C0hZnZuI5YHYs-wOtNF05uj7EwZgn1_mv2LJIVI_xjGWczBG_Z5JLyoeWfIRkz9y1lYceRO3Gr58qG2ygpumkCqMwGscIeO7aX_4AwcepY_-DNWq4r7J98pn6uOFUguAJ2LY--mauLntt1v9hNr2z2JrLrWuzKJD8ZauhPJO5s6qd5JIQGloygqTEA5g_O33E2hdiD4bHO6SLUs3ckz3P32xbstw5xJMSJyeo0GB82MrtL2_f6qNwAq1YwxQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 21:03:34.145 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 21:03:34.145 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 21:03:34.482 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:03:34.808 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:03:34.810 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:03:34.811 +05:30 [DBG] No PKCE used.
2018-04-23 21:03:34.877 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:35.046 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:35.119 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:35.293 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:35.295 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:03:35.589 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:03:43.538 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 21:03:43.721 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:03:44.040 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:03:44.042 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:03:44.042 +05:30 [DBG] No PKCE used.
2018-04-23 21:03:44.116 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:44.275 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:44.348 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:03:44.513 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:03:44.515 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:03:44.564 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD95U8FSB8K:00000003",
  "TimeStamp": "2018-04-23T15:33:44Z",
  "ProcessId": 11352,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:04:03.923 +05:30 [ERR] Failed executing DbCommand (37ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 200), @p2='?', @p3='?' (Size = 4000), @p4='?', @p5='?' (Size = 200), @p6='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [PersistedGrants] ([Key], [ClientId], [CreationTime], [Data], [Expiration], [SubjectId], [Type])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Data', table 'LearnIdp.IdentityDb.dbo.PersistedGrants'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:21dadae6-9a39-401c-b322-e55f0478d32c
Error Number:515,State:2,Class:16
2018-04-23 21:04:03.982 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Data', table 'LearnIdp.IdentityDb.dbo.PersistedGrants'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(Tuple`2 parameters)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IReadOnlyList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IReadOnlyList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'Data', table 'LearnIdp.IdentityDb.dbo.PersistedGrants'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(Tuple`2 parameters)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IReadOnlyList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IReadOnlyList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2018-04-23 21:04:36.357 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 21:04:36.394 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 21:04:36.394 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 21:04:36.395 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 21:04:36.395 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 21:04:51.995 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 21:04:52.002 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 21:04:52.002 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 21:04:52.008 +05:30 [DBG] Start discovery request
2018-04-23 21:04:53.285 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 21:04:53.623 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 21:04:53.648 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 21:04:53.649 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 21:04:53.658 +05:30 [DBG] Start key discovery request
2018-04-23 21:04:53.774 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 21:04:53.784 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 21:04:53.785 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 21:04:53.794 +05:30 [DBG] Start authorize request
2018-04-23 21:04:53.809 +05:30 [DBG] No user present in authorize request
2018-04-23 21:04:53.815 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:04:54.426 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:04:54.435 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:04:54.436 +05:30 [DBG] No PKCE used.
2018-04-23 21:04:54.536 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-23 21:04:54.541 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-23 21:04:54.544 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-23 21:04:54.544 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:04:54.550 +05:30 [DBG] Start authorize request
2018-04-23 21:04:54.552 +05:30 [DBG] No user present in authorize request
2018-04-23 21:04:54.552 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:04:54.833 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:04:54.834 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:04:54.835 +05:30 [DBG] No PKCE used.
2018-04-23 21:04:54.882 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:04:55.304 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:04:55.304 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:04:55.441 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:04:55.441 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:04:55.729 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:04:55.758 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:04:55.768 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:04:55.768 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:04:55.786 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
  "Nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 21:04:55.786 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
  "Nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 21:04:55.807 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 21:04:55.807 +05:30 [INF] Showing login: User is not authenticated
2018-04-23 21:04:56.161 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:04:56.491 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:04:56.493 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:04:56.494 +05:30 [DBG] No PKCE used.
2018-04-23 21:04:56.564 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:04:56.735 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:04:56.812 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:04:56.983 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:04:56.985 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:04:57.295 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:07.703 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 21:05:07.870 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:05:08.202 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:08.204 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:05:08.204 +05:30 [DBG] No PKCE used.
2018-04-23 21:05:08.264 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:08.426 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:08.492 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:08.656 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:08.658 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:05:08.701 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD95V0OH2D6:00000003",
  "TimeStamp": "2018-04-23T15:35:08Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:14.217 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD95V0OH2D6:00000003",
  "TimeStamp": "2018-04-23T15:35:08Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:16.679 +05:30 [DBG] Augmenting SignInContext
2018-04-23 21:05:16.681 +05:30 [DBG] Adding idp claim with value: local
2018-04-23 21:05:16.682 +05:30 [DBG] Adding amr claim with value: pwd
2018-04-23 21:05:16.698 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 21:05:16.723 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:16.727 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:16.730 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 21:05:16.731 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 21:05:16.732 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 21:05:16.740 +05:30 [DBG] Start authorize callback request
2018-04-23 21:05:16.745 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 21:05:16.746 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:05:16.973 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:16.974 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:05:16.974 +05:30 [DBG] No PKCE used.
2018-04-23 21:05:17.020 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:17.141 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:17.187 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:17.302 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:17.304 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:05:17.305 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
  "Nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
  "SessionId": "bf712bb2ee596cd6702ff4c04f43c988",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 21:05:17.358 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 21:05:17.358 +05:30 [INF] Showing consent: User has not yet consented
2018-04-23 21:05:17.375 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:17.378 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:17.423 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:05:17.750 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:17.751 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:05:17.751 +05:30 [DBG] No PKCE used.
2018-04-23 21:05:17.820 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:17.985 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:18.058 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:18.232 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:18.234 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:05:18.519 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:18.586 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:18.821 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:24.378 +05:30 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 21:05:24.380 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:24.385 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:24.446 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:05:24.803 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:24.804 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:05:24.804 +05:30 [DBG] No PKCE used.
2018-04-23 21:05:24.876 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:25.157 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:25.230 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:25.474 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:25.476 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:05:25.512 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:25.517 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-04-23 21:05:25.520 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-23 21:05:25.522 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-23 21:05:25.524 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-23 21:05:25.526 +05:30 [DBG] Start authorize callback request
2018-04-23 21:05:25.562 +05:30 [DBG] User in authorize request: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 21:05:25.563 +05:30 [DBG] Start authorize request protocol validation
2018-04-23 21:05:25.832 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:25.834 +05:30 [DBG] Checking for PKCE parameters
2018-04-23 21:05:25.834 +05:30 [DBG] No PKCE used.
2018-04-23 21:05:25.891 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:26.096 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:26.154 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:26.361 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:26.363 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-23 21:05:26.364 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost/ImageGallery/signin-oidc"
  ],
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address user-role imagegallery-api subscription country offline_access",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
  "Nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
  "SessionId": "bf712bb2ee596cd6702ff4c04f43c988",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address user-role imagegallery-api subscription country offline_access",
    "response_mode": "form_post",
    "nonce": "636600944937489428.OTY4MmZmZTItNDI1NS00MDUzLThlMzEtOGI2NjYwODYxZTkwNmNiODEwZGUtMmFlNS00ODIyLWE0ZWEtZjM0OWJmMzM0ZDAz",
    "state": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-23 21:05:26.395 +05:30 [DBG] Scopes contains offline_access, consent is required
2018-04-23 21:05:26.402 +05:30 [INF] User consented to scopes: ["openid","profile","address","user-role","country","subscription","imagegallery-api","offline_access"]
2018-04-23 21:05:26.409 +05:30 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 21:05:26.456 +05:30 [DBG] no jXWVibLM4xh12BztjP3Qn6Npoa8FJh0KMqxmbZdyuRw= persisted grant found in database
2018-04-23 21:05:26.465 +05:30 [DBG] Creating Hybrid Flow response.
2018-04-23 21:05:26.536 +05:30 [DBG] vGu1W/4FacV+XqbLP6jbH/DPyKCVJslQsnt91ebRKcM= not found in database
2018-04-23 21:05:26.590 +05:30 [DBG] Creating Implicit Flow response.
2018-04-23 21:05:26.603 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 21:05:26.606 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 21:05:26.683 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****OL9w"
    },
    {
      "TokenType": "code",
      "TokenValue": "****2cb9"
    }
  ],
  "ActivityId": "0HLD95V0OH2D6:00000007",
  "TimeStamp": "2018-04-23T15:35:26Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:26.700 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "ClientId": "ImageGallery-WebApp",
  "RedirectUri": "http://localhost/imagegallery/signin-oidc",
  "State": "CfDJ8Kt9vN7ZeHdHuQn6ty5TyqsEm282QhyLHBQ788XN09ubWS66OQppOPy7h5yUkMti8nFc17eKi96Uc1XZYoFnVkT0jxYV8qO-DHiguSrBIWSccdAs6bAqFQi_oR-c5UsgM-5UJcTZPeifBmJlhXZGch1LfTxGxDl8iIdjaW0rgqMH6El9hTAbq_hQqA3qChtLKEV57GNRhDd6L1BSUHy1tQNrA2dm0xj07gfGiHSuT_9YSlW4G9A5X-dI0azM69few2BfI_OllWxfropTujPp2zr1HXGUmm_dM37KmUFtjd757XpHgPhiEZRpgxlBFP6hBw89BEdQyadwRZx-6_w0eJI",
  "Scope": "openid profile address user-role subscription country imagegallery-api offline_access"
}
2018-04-23 21:05:26.733 +05:30 [DBG] Augmenting SignInContext
2018-04-23 21:05:26.734 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-04-23 21:05:26.946 +05:30 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-23 21:05:26.954 +05:30 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-23 21:05:26.954 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-23 21:05:26.970 +05:30 [DBG] Start token request.
2018-04-23 21:05:26.977 +05:30 [DBG] Start client validation
2018-04-23 21:05:26.985 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 21:05:26.989 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 21:05:26.990 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 21:05:26.991 +05:30 [DBG] Secret id found: ImageGallery-WebApp
2018-04-23 21:05:27.455 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:27.468 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 21:05:27.469 +05:30 [DBG] Client validation success
2018-04-23 21:05:27.474 +05:30 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ImageGallery-WebApp",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD95V0OH2D4:00000003",
  "TimeStamp": "2018-04-23T15:35:27Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:27.484 +05:30 [DBG] Start token request validation
2018-04-23 21:05:27.495 +05:30 [DBG] Start validation of authorization code token request
2018-04-23 21:05:27.536 +05:30 [DBG] vGu1W/4FacV+XqbLP6jbH/DPyKCVJslQsnt91ebRKcM= found in database: true
2018-04-23 21:05:27.585 +05:30 [DBG] removing vGu1W/4FacV+XqbLP6jbH/DPyKCVJslQsnt91ebRKcM= persisted grant from database
2018-04-23 21:05:27.645 +05:30 [DBG] Validation of authorization code token request success
2018-04-23 21:05:27.651 +05:30 [INF] Token request validation success
{
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "49dffd31e286037a3dffa46c48a2c4e26f122065cc95e7ed1a725c3267102cb9",
  "Raw": {
    "client_id": "ImageGallery-WebApp",
    "client_secret": "***REDACTED***",
    "code": "49dffd31e286037a3dffa46c48a2c4e26f122065cc95e7ed1a725c3267102cb9",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost/imagegallery/signin-oidc"
  }
}
2018-04-23 21:05:27.922 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:27.978 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:28.175 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:28.189 +05:30 [DBG] Getting claims for access token for client: ImageGallery-WebApp
2018-04-23 21:05:28.190 +05:30 [DBG] Getting claims for access token for subject: d860efca-22d9-47fd-8249-791ba61b07c7
2018-04-23 21:05:28.320 +05:30 [DBG] t7KV0OHJuEeYvjOqh9CqBNK9ona5JVgE+i0UnzO2I9w= not found in database
2018-04-23 21:05:28.351 +05:30 [DBG] Creating refresh token
2018-04-23 21:05:28.351 +05:30 [DBG] Setting an absolute lifetime: 2592000
2018-04-23 21:05:28.391 +05:30 [DBG] p7LGJnu9eP1RmaNU1kW+gxs1gkfMOX0S6kMmms2+Fak= not found in database
2018-04-23 21:05:28.649 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:28.703 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:28.823 +05:30 [DBG] Found ["imagegallery-api"] API scopes in database
2018-04-23 21:05:28.826 +05:30 [DBG] Getting claims for identity token for subject: d860efca-22d9-47fd-8249-791ba61b07c7 and client: ImageGallery-WebApp
2018-04-23 21:05:28.826 +05:30 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-23 21:05:28.832 +05:30 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ImageGallery-WebApp",
  "ClientName": "Image Gallery",
  "Endpoint": "Token",
  "Scopes": "openid profile address user-role subscription country imagegallery-api offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****jaQA"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****f902"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****1c47"
    }
  ],
  "ActivityId": "0HLD95V0OH2D4:00000003",
  "TimeStamp": "2018-04-23T15:35:28Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:28.840 +05:30 [DBG] Token request success.
2018-04-23 21:05:28.863 +05:30 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-23 21:05:28.866 +05:30 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-23 21:05:28.867 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-23 21:05:28.880 +05:30 [DBG] Start userinfo request
2018-04-23 21:05:28.884 +05:30 [DBG] Bearer token found in header
2018-04-23 21:05:28.935 +05:30 [DBG] t7KV0OHJuEeYvjOqh9CqBNK9ona5JVgE+i0UnzO2I9w= found in database: true
2018-04-23 21:05:29.190 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:29.456 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:29.483 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 21:05:29.490 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "06f7e6999f6d9d98f4ab5dc3d790fc1a6d5fd19f4e1758bc6d3e96c6b2681c47",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524497728,
    "exp": 1524497848,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524497716,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 21:05:29.524 +05:30 [DBG] Creating userinfo response
2018-04-23 21:05:29.531 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 21:05:29.536 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 21:05:29.598 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:29.600 +05:30 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture address role country subscription
2018-04-23 21:05:29.601 +05:30 [DBG] Scopes in access token: openid profile address user-role country subscription imagegallery-api offline_access
2018-04-23 21:05:29.648 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription"] identity scopes in database
2018-04-23 21:05:29.695 +05:30 [INF] Profile service returned to the following claim types: address role subscription country given_name
2018-04-23 21:05:29.700 +05:30 [DBG] End userinfo request
2018-04-23 21:05:31.736 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-23 21:05:31.738 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-23 21:05:31.739 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-23 21:05:31.741 +05:30 [DBG] Start discovery request
2018-04-23 21:05:31.908 +05:30 [DBG] Found ["openid","profile","address","user-role","country","subscription","imagegallery-api"] as all scopes in database
2018-04-23 21:05:31.943 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-23 21:05:31.945 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-23 21:05:31.945 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-23 21:05:31.948 +05:30 [DBG] Start key discovery request
2018-04-23 21:05:32.137 +05:30 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2018-04-23 21:05:32.141 +05:30 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2018-04-23 21:05:32.142 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2018-04-23 21:05:32.153 +05:30 [DBG] Starting introspection request.
2018-04-23 21:05:32.161 +05:30 [DBG] Start parsing Basic Authentication secret
2018-04-23 21:05:32.161 +05:30 [DBG] Start parsing for secret in post body
2018-04-23 21:05:32.162 +05:30 [DBG] Parser found secret: PostBodySecretParser
2018-04-23 21:05:32.163 +05:30 [DBG] Secret id found: imagegallery-api
2018-04-23 21:05:32.330 +05:30 [DBG] Found imagegallery-api API resource in database
2018-04-23 21:05:32.332 +05:30 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-23 21:05:32.332 +05:30 [DBG] API resource validation success
2018-04-23 21:05:32.337 +05:30 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "imagegallery-api",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD95V0OH2D8:00000001",
  "TimeStamp": "2018-04-23T15:35:32Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:32.346 +05:30 [DBG] Introspection request validation started.
2018-04-23 21:05:32.374 +05:30 [DBG] t7KV0OHJuEeYvjOqh9CqBNK9ona5JVgE+i0UnzO2I9w= found in database: true
2018-04-23 21:05:32.611 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:32.830 +05:30 [DBG] ImageGallery-WebApp found in database: true
2018-04-23 21:05:32.859 +05:30 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-23 21:05:32.861 +05:30 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "06f7e6999f6d9d98f4ab5dc3d790fc1a6d5fd19f4e1758bc6d3e96c6b2681c47",
  "Claims": {
    "iss": "http://localhost:5000",
    "nbf": 1524497728,
    "exp": 1524497848,
    "aud": [
      "http://localhost:5000/resources",
      "imagegallery-api"
    ],
    "client_id": "ImageGallery-WebApp",
    "scope": [
      "openid",
      "profile",
      "address",
      "user-role",
      "country",
      "subscription",
      "imagegallery-api",
      "offline_access"
    ],
    "sub": "d860efca-22d9-47fd-8249-791ba61b07c7",
    "auth_time": 1524497716,
    "idp": "local",
    "amr": "pwd",
    "address": "Home Street, Home City",
    "role": "paiduser",
    "subscription": "paiduser",
    "country": "in",
    "given_name": "Umar"
  }
}
2018-04-23 21:05:32.861 +05:30 [DBG] Introspection request validation successful.
2018-04-23 21:05:32.875 +05:30 [DBG] Creating introspection response for active token.
2018-04-23 21:05:32.886 +05:30 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "imagegallery-api",
  "IsActive": true,
  "Token": "****1c47",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "address",
    "role",
    "subscription",
    "country",
    "given_name"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "address",
    "user-role",
    "country",
    "subscription",
    "imagegallery-api",
    "offline_access"
  ],
  "ActivityId": "0HLD95V0OH2D8:00000001",
  "TimeStamp": "2018-04-23T15:35:32Z",
  "ProcessId": 57540,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 21:05:32.891 +05:30 [INF] Success token introspection. Token active: true, for API name: imagegallery-api
2018-04-23 22:01:00.362 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-04-23 22:01:00.394 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-04-23 22:01:00.396 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-04-23 22:01:00.396 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-04-23 22:01:00.397 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-04-23 22:04:15.055 +05:30 [INF] AuthenticationScheme: idsrv was challenged.
2018-04-23 22:04:20.007 +05:30 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-23 22:04:20.388 +05:30 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "umar",
  "SubjectId": "d860efca-22d9-47fd-8249-791ba61b07c7",
  "DisplayName": "umar",
  "Endpoint": "UI",
  "ActivityId": "0HLD970472D2E:00000007",
  "TimeStamp": "2018-04-23T16:34:20Z",
  "ProcessId": 32144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-23 22:04:20.393 +05:30 [ERR] An unhandled exception has occurred while executing the request
System.NullReferenceException: Object reference not set to an instance of an object.
   at IdentityHost.Controllers.Account.AccountController.<Login>d__8.MoveNext() in C:\Users\Umar\Documents\Visual Studio 2017\Projects\LearnIdp\IdentityHost\Controllers\Account\AccountController.cs:line 122
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
